<html>
<header>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta http-equiv="Content-Style-Type" content="text/css">
	<title>diagram internal</title>
	<link rel=stylesheet href="./default.css">
</header>
<body>
<div class='toc_button_top'><a href='#0qJQvVjc3Xy'>
<svg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 200 200'>
<defs><g id='line'>
  <circle cx='45' cy='50' r='15' fill='white' stroke='none' stroke-width='1' />
  <polyline fill='none' stroke='white' stroke-width='20' points=' 75.0,50.0 170.0,50.0' />
</g></defs>
<rect x='0' y='0' width='200' height='200' rx='30' ry='30' fill='lightgray' stroke='none' stroke-width='1' />
<use xlink:href='#line' x='0' y='0' />
<use xlink:href='#line' x='0' y='50' />
<use xlink:href='#line' x='0' y='100' />
</svg>
</a></div>
<!-- define: APPNAME = diagram -->
<!-- define: BLANK_PARAGRAPH = '　　' -->
<!-- define: TODO = '@((background:red;color:white;)(ToDo : %1))' -->
<!-- <!-- config:term-link-in-header -->			
<!-- config:write-comment -->			
<!-- config:header-numbering 2 5 -->
<h1><a name='kfFuRvOrdfv'></a>diagram internal documents</h1>
<p>　この文書は、 <strong><a class='autolink' href='#2xCCaUuNLlH'>diagram</a></strong> の内部設計文書です。</p>
<h2><a name='0qJQvVjc3Xy'></a>1 Table of contents</h2>
<li class='tocx'><a href='#0qJQvVjc3Xy'>1 Table of contents</a></li>
<details class='tocx' open>
<summary class='tocx'><a href='#iUs1vEgM0gr'>2 概念</a></summary>
<blockquote class='tocx'>
<li class='tocx'><a href='#a6YbzgTm8yY'>2.1 座標系</a></li>
<li class='tocx'><a href='#jXsxcbXYkll'>2.2 キャンバス</a></li>
<li class='tocx'><a href='#hQqTfTkbNyq'>2.3 エンティティ</a></li>
<li class='tocx'><a href='#hv2FXS6j5gn'>2.4 ディクショナリ</a></li>
<li class='tocx'><a href='#1rpUB3fre67'>2.5 色の指定</a></li>
</blockquote>
</details>
<details class='tocx' open>
<summary class='tocx'><a href='#bzrfEUL5NBz'>3 src 配下のコンポーネント</a></summary>
<blockquote class='tocx'>
<li class='tocx'><a href='#5PHdXU1SAwU'>3.1 arc.lisp</a></li>
<li class='tocx'><a href='#jRts0Y6YUfH'>3.2 binutil.lisp</a></li>
<details class='tocx' open>
<summary class='tocx'><a href='#jkshMjTfNSO'>3.3 canvas.lisp</a></summary>
<blockquote class='tocx'>
<li class='tocx'><a href='#92zJ4HjAUik'>3.3.1 make-canvas 関数</a></li>
<li class='tocx'><a href='#cTwJaoEIPT1'>3.3.2 copy-canvas 関数</a></li>
<li class='tocx'><a href='#1HAaPkwx2sJ'>3.3.3 canvas-p 関数</a></li>
<li class='tocx'><a href='#efXUIZFt7c7'>3.3.4 canvas-topleft 関数</a></li>
<li class='tocx'><a href='#cSuiLry4j2n'>3.3.5 canvas-left 関数</a></li>
<li class='tocx'><a href='#6vlqkJUhc5s'>3.3.6 canvas-top 関数</a></li>
<li class='tocx'><a href='#fM6z1S2PXli'>3.3.7 canvas-right 関数</a></li>
<li class='tocx'><a href='#3KzHqSMKOM6'>3.3.8 canvas-bottom 関数</a></li>
<li class='tocx'><a href='#kz1CArkN4MX'>3.3.9 canvas-width 関数</a></li>
<li class='tocx'><a href='#gl7uceIWuvQ'>3.3.10 canvas-height 関数</a></li>
<li class='tocx'><a href='#5zrSjOXYv2S'>3.3.11 canvas-fix-point 関数</a></li>
<li class='tocx'><a href='#8SwZig7eicm'>3.3.12 with-canvas マクロ</a></li>
<li class='tocx'><a href='#a48ATArhBUk'>3.3.13 with-subcanvas マクロ</a></li>
<li class='tocx'><a href='#5r9jjHGdPUD'>3.3.14 canvas-dict-width 関数</a></li>
<li class='tocx'><a href='#42betqaDwBK'>3.3.15 canvas-dict-height 関数</a></li>
<li class='tocx'><a href='#g1qrFI5J49t'>3.3.16 canvas-dict-topleft 関数</a></li>
<li class='tocx'><a href='#6LB76PkdkZJ'>3.3.17 canvas-dict-top 関数</a></li>
<li class='tocx'><a href='#dHAbaoBcL3P'>3.3.18 canvas-dict-topright 関数</a></li>
<li class='tocx'><a href='#jY1KoLc5Ygu'>3.3.19 canvas-dict-left 関数</a></li>
<li class='tocx'><a href='#jbqMd3uQuTg'>3.3.20 canvas-dict-center 関数</a></li>
<li class='tocx'><a href='#8QTTuc8dfLe'>3.3.21 canvas-dict-right 関数</a></li>
<li class='tocx'><a href='#iyqoOBS1Fx2'>3.3.22 canvas-dict-bottomleft 関数</a></li>
<li class='tocx'><a href='#g2Q4C1SxBla'>3.3.23 canvas-dict-bottom 関数</a></li>
<li class='tocx'><a href='#6sY8VX3mC8y'>3.3.24 canvas-dict-bottomright 関数</a></li>
</blockquote>
</details>
<li class='tocx'><a href='#0vu6jIAdrHn'>3.4 circle.lisp</a></li>
<details class='tocx' open>
<summary class='tocx'><a href='#6qK0TBix0mp'>3.5 cl-diagram.lisp</a></summary>
<blockquote class='tocx'>
<li class='tocx'><a href='#dQph0tOdHQ4'>3.5.1 string/mid 関数</a></li>
<li class='tocx'><a href='#dS6SufHR3Ix'>3.5.2 string/replace 関数</a></li>
<li class='tocx'><a href='#gtO8775YqBc'>3.5.3 string/split 関数</a></li>
<li class='tocx'><a href='#fO1t1ED8A9I'>3.5.4 onlisp/mkstr 関数</a></li>
<li class='tocx'><a href='#kGO3CobDdFK'>3.5.5 onlisp/symb 関数</a></li>
<li class='tocx'><a href='#amdyJtzHvGs'>3.5.6 onlisp/keysymb 関数</a></li>
<li class='tocx'><a href='#8P16jLcfrTL'>3.5.7 onlisp/flatten 関数</a></li>
<li class='tocx'><a href='#8bLRXqBRaO7'>3.5.8 fix-name 関数</a></li>
<li class='tocx'><a href='#aILr24BuzyN'>3.5.9 __write-imp 関数</a></li>
<li class='tocx'><a href='#8n4YMx0lEny'>3.5.10 exception コンディション</a></li>
<li class='tocx'><a href='#kiT1zMbnS1G'>3.5.11 caution コンディション</a></li>
<li class='tocx'><a href='#hKajqxDpSVa'>3.5.12 throw-exception マクロ</a></li>
<li class='tocx'><a href='#g7f5yssQwTG'>3.5.13 throw-caution マクロ</a></li>
<li class='tocx'><a href='#4MzkIlZeOig'>3.5.14 type-assert マクロ</a></li>
<li class='tocx'><a href='#9c7EgdLRM3i'>3.5.15 chk-type マクロ</a></li>
<li class='tocx'><a href='#ctyQaetTK05'>3.5.16 format-string 関数</a></li>
<li class='tocx'><a href='#4agHkkJhiI1'>3.5.17 check-member マクロ</a></li>
<li class='tocx'><a href='#8UPDTpCxfvu'>3.5.18 check-object マクロ</a></li>
<li class='tocx'><a href='#byoOCbZmVzI'>3.5.19 check-keywords マクロ</a></li>
<li class='tocx'><a href='#7OeiJB9pyPw'>3.5.20 check-numbers マクロ</a></li>
<li class='tocx'><a href='#banMcDxF6dd'>3.5.21 write-when マクロ</a></li>
<li class='tocx'><a href='#k9ex0jPxy6W'>3.5.22 with-dictionary マクロ</a></li>
<li class='tocx'><a href='#koEWNsjRkGS'>3.5.23 escape-characters 関数</a></li>
<li class='tocx'><a href='#kWO3U8sB5EC'>3.5.24 to-property-strings 総称関数</a></li>
<li class='tocx'><a href='#6KE7wGjrGwN'>3.5.25 to-style-strings 総称関数</a></li>
<li class='tocx'><a href='#dam9QmgaZrq'>3.5.26 check 総称関数</a></li>
<li class='tocx'><a href='#7QraN5WNGea'>3.5.27 rgb 関数</a></li>
</blockquote>
</details>
<li class='tocx'><a href='#gjxTJAKDoPj'>3.6 connector.lisp</a></li>
<li class='tocx'><a href='#3c2PhHDsO5I'>3.7 constants.lisp</a></li>
<details class='tocx' open>
<summary class='tocx'><a href='#jCwDkKC4S8s'>3.8 create-svg.lisp</a></summary>
<blockquote class='tocx'>
<li class='tocx'><a href='#bpd2tQ1LZ9f'>3.8.1 create-svg マクロ</a></li>
<li class='tocx'><a href='#2xCCaUuNLlH'>3.8.2 diagram マクロ</a></li>
</blockquote>
</details>
<details class='tocx' open>
<summary class='tocx'><a href='#kCVvdOT2S7L'>3.9 dictionary.lisp</a></summary>
<blockquote class='tocx'>
<li class='tocx'><a href='#8sXKk1Q8d2H'>3.9.1 dictionary クラス</a></li>
<li class='tocx'><a href='#6XTh8JnAh0Q'>3.9.2 dict-create 関数</a></li>
<li class='tocx'><a href='#1X7zDLB8Dho'>3.9.3 dict-register 関数</a></li>
<li class='tocx'><a href='#ihOjTTad5LY'>3.9.4 dict-get-entity 関数</a></li>
</blockquote>
</details>
<li class='tocx'><a href='#hd7ThdvzqQq'>3.10 ellipse.lisp</a></li>
<li class='tocx'><a href='#4V2uI4HhR9d'>3.11 endmark-info.lisp</a></li>
<details class='tocx' open>
<summary class='tocx'><a href='#h05k6V1sTsF'>3.12 entity.lisp</a></summary>
<blockquote class='tocx'>
<li class='tocx'><a href='#coMfaBWu7eG'>3.12.1 entity クラス</a></li>
<li class='tocx'><a href='#h7eqOL9fNA4'>3.12.2 begin-id-group 関数</a></li>
<li class='tocx'><a href='#bFrl4dwpxKu'>3.12.3 end-id-group 関数</a></li>
<li class='tocx'><a href='#dBxV4D4cAYB'>3.12.4 entity-composition-p 総称関数</a></li>
<li class='tocx'><a href='#3ffyzBxLMJk'>3.12.5 write-header 総称関数</a></li>
<li class='tocx'><a href='#aOXIgO3wNWv'>3.12.6 pre-draw 総称関数</a></li>
<li class='tocx'><a href='#9lFMWTnv8EC'>3.12.7 post-draw 総称関数</a></li>
<li class='tocx'><a href='#eRs3IQibPlS'>3.12.8 draw-entity 総称関数</a></li>
<li class='tocx'><a href='#kXeJPcGPcpP'>3.12.9 check-and-draw-local-entity 関数</a></li>
</blockquote>
</details>
<details class='tocx' open>
<summary class='tocx'><a href='#au8IebMfeov'>3.13 fill-info.lisp</a></summary>
<blockquote class='tocx'>
<li class='tocx'><a href='#g99vlb6tXRZ'>3.13.1 *default-fill*変数</a></li>
<li class='tocx'><a href='#fDv1lctqo7i'>3.13.2 fill-info クラス</a></li>
<li class='tocx'><a href='#8IkB7VinE7h'>3.13.3 make-fill 関数</a></li>
<li class='tocx'><a href='#apbktIICmZP'>3.13.4 with-fill マクロ</a></li>
</blockquote>
</details>
<li class='tocx'><a href='#l9bqLva3rj6'>3.14 font-info.lisp</a></li>
<li class='tocx'><a href='#dxGh4wRHKeg'>3.15 group.lisp</a></li>
<li class='tocx'><a href='#4ukAyTPlA3e'>3.16 image.lisp</a></li>
<li class='tocx'><a href='#hNccIQgX3H4'>3.17 label-info.lisp</a></li>
<li class='tocx'><a href='#g6PVqK0GAdf'>3.18 layer-manager.lisp</a></li>
<li class='tocx'><a href='#7Y5KOwJXVqF'>3.19 line.lisp</a></li>
<li class='tocx'><a href='#k0U5yutENit'>3.20 link-info.lisp</a></li>
<details class='tocx' open>
<summary class='tocx'><a href='#0uaBbu9jd7a'>3.21 mathutil.lisp</a></summary>
<blockquote class='tocx'>
<li class='tocx'><a href='#67nITShIFxJ'>3.21.1 math/len2 関数</a></li>
<li class='tocx'><a href='#g56JpESyFgh'>3.21.2 math/len4 関数</a></li>
<li class='tocx'><a href='#fCFNMHaH1sc'>3.21.3 math/sin1 関数</a></li>
<li class='tocx'><a href='#19JyiABSLdD'>3.21.4 math/cos1 関数</a></li>
<li class='tocx'><a href='#hvzNb6abVJr'>3.21.5 math/sin2 関数</a></li>
<li class='tocx'><a href='#9Uw5mXSJ6LO'>3.21.6 math/cos2 関数</a></li>
<li class='tocx'><a href='#6pdmmd85Tsd'>3.21.7 math/sin3 関数</a></li>
<li class='tocx'><a href='#kMKsf1DD0li'>3.21.8 math/cos3 関数</a></li>
<li class='tocx'><a href='#4NyvBxygvjx'>3.21.9 math/sin4 関数</a></li>
<li class='tocx'><a href='#cjix05YHSz4'>3.21.10 math/cos4 関数</a></li>
<li class='tocx'><a href='#fFCXUJE5Dqj'>3.21.11 math/sin5 関数</a></li>
<li class='tocx'><a href='#1cLxT7jnweu'>3.21.12 math/cos5 関数</a></li>
</blockquote>
</details>
<li class='tocx'><a href='#bFs5bJqLCfb'>3.22 paragraph.lisp</a></li>
<li class='tocx'><a href='#9k30aVu2Utl'>3.23 path.lisp</a></li>
<details class='tocx' open>
<summary class='tocx'><a href='#kEmV3k1rXYD'>3.24 pathutil.lisp</a></summary>
<blockquote class='tocx'>
<li class='tocx'><a href='#jwjWt2iFfEC'>3.24.1 path/is-directory-name 関数</a></li>
<li class='tocx'><a href='#dnb6iFWVo0r'>3.24.2 path/is-file-name 関数</a></li>
<li class='tocx'><a href='#0gP9e1yak7W'>3.24.3 path/is-exists 関数</a></li>
<li class='tocx'><a href='#9bWAiPeVsu8'>3.24.4 path/is-existing-file 関数</a></li>
<li class='tocx'><a href='#6UyJ4WDXJRL'>3.24.5 path/get-time 関数</a></li>
<li class='tocx'><a href='#hMXfb1i1Vwi'>3.24.6 path/get-current-directory 関数</a></li>
<li class='tocx'><a href='#59X9Til78JV'>3.24.7 path/set-current-directory 関数</a></li>
</blockquote>
</details>
<details class='tocx' open>
<summary class='tocx'><a href='#g7U0GGx7sCV'>3.25 point.lisp</a></summary>
<blockquote class='tocx'>
<li class='tocx'><a href='#cV08aR4hVCU'>3.25.1 make-point 関数</a></li>
<li class='tocx'><a href='#i9EtqjnJKkh'>3.25.2 copy-point 関数</a></li>
<li class='tocx'><a href='#eYsB94h8ozm'>3.25.3 point-p 関数</a></li>
<li class='tocx'><a href='#k76Q8kszUmj'>3.25.4 point-absolute-p 関数</a></li>
<li class='tocx'><a href='#8ARSCNEXCwM'>3.25.5 point-relative-p 関数</a></li>
<li class='tocx'><a href='#et6gePtgg50'>3.25.6 point-x 関数</a></li>
<li class='tocx'><a href='#3B2wOhg6fxU'>3.25.7 point-y 関数</a></li>
<li class='tocx'><a href='#fCZ08hHsf3N'>3.25.8 point+ 関数</a></li>
<li class='tocx'><a href='#6mwEJ7qyOKN'>3.25.9 point- 関数</a></li>
<li class='tocx'><a href='#lEZ6oy96fUH'>3.25.10 point/x+ 関数</a></li>
<li class='tocx'><a href='#awgH1J8YsIC'>3.25.11 point/y+ 関数</a></li>
<li class='tocx'><a href='#3nSG8ftc6m8'>3.25.12 point/xy+ 関数</a></li>
<li class='tocx'><a href='#1cQLTt5yCRi'>3.25.13 point-distance 関数</a></li>
<li class='tocx'><a href='#ekClPzGH4mL'>3.25.14 with-point マクロ</a></li>
</blockquote>
</details>
<li class='tocx'><a href='#ggdkX0SpYat'>3.26 polygon.lisp</a></li>
<li class='tocx'><a href='#g7IEYVlAFRK'>3.27 raw-svg.lisp</a></li>
<li class='tocx'><a href='#c1IDRaD20g3'>3.28 rectangle.lisp</a></li>
<details class='tocx' open>
<summary class='tocx'><a href='#jzen8zyw08N'>3.29 shape.lisp</a></summary>
<blockquote class='tocx'>
<li class='tocx'><a href='#f9LBhHlQ8Wm'>3.29.1 shape クラス</a></li>
<li class='tocx'><a href='#2UPPgaElgvy'>3.29.2 shape-width 総称関数</a></li>
<li class='tocx'><a href='#lNU1gDLketF'>3.29.3 shape-height 総称関数</a></li>
<li class='tocx'><a href='#7aZE8rCgP1F'>3.29.4 shape-topleft 総称関数</a></li>
<li class='tocx'><a href='#kt6vKeEZlsN'>3.29.5 shape-top 総称関数</a></li>
<li class='tocx'><a href='#85obV2niPlm'>3.29.6 shape-topright 総称関数</a></li>
<li class='tocx'><a href='#jmh0xrnq31t'>3.29.7 shape-left 総称関数</a></li>
<li class='tocx'><a href='#9FXddyX6ENz'>3.29.8 shape-center 総称関数</a></li>
<li class='tocx'><a href='#h5SgyhRzdMg'>3.29.9 shape-right 総称関数</a></li>
<li class='tocx'><a href='#jDeI5NMpwGo'>3.29.10 shape-bottomleft 総称関数</a></li>
<li class='tocx'><a href='#5oyJIEI5Oql'>3.29.11 shape-bottom 総称関数</a></li>
<li class='tocx'><a href='#3LYUCViihmz'>3.29.12 shape-bottomright 総称関数</a></li>
<li class='tocx'><a href='#00NZ1og0jJj'>3.29.13 shape-get-subcanvas 総称関数</a></li>
<li class='tocx'><a href='#cGVh1Proq0b'>3.29.14 shape-cc-center 総称関数</a></li>
<li class='tocx'><a href='#itSpZJR99MH'>3.29.15 shape-connect-point 総称関数</a></li>
</blockquote>
</details>
<li class='tocx'><a href='#0ACA2jPppKO'>3.30 stencil.lisp</a></li>
<details class='tocx' open>
<summary class='tocx'><a href='#5S5mEI6PrDL'>3.31 stroke-info.lisp</a></summary>
<blockquote class='tocx'>
<li class='tocx'><a href='#7pITpDTSaVn'>3.31.1 *default-stroke*変数</a></li>
<li class='tocx'><a href='#60ZvGU5q6jR'>3.31.2 stroke-info クラス</a></li>
<li class='tocx'><a href='#ezUVhtPwl3J'>3.31.3 make-stroke 関数</a></li>
<li class='tocx'><a href='#3HMiuSfZ8IU'>3.31.4 with-stroke マクロ</a></li>
</blockquote>
</details>
<li class='tocx'><a href='#b75JrIWLwQA'>3.32 stylesheet.lisp</a></li>
<li class='tocx'><a href='#kNkTqs2VjiA'>3.33 text-shape.lisp</a></li>
<li class='tocx'><a href='#e2wwJD0JZFB'>3.34 text.lisp</a></li>
<details class='tocx' open>
<summary class='tocx'><a href='#7NkNOcI9zDh'>3.35 writer.lisp</a></summary>
<blockquote class='tocx'>
<details class='tocx' open>
<summary class='tocx'><a href='#lfl3LZgcQAj'>3.35.1 buffer-writer クラス</a></summary>
<blockquote class='tocx'>
<li class='tocx'><a href='#k0nOlL9rkAA'>3.35.1.1 writer-write メソッド</a></li>
<li class='tocx'><a href='#4OQ1LGMatRX'>3.35.1.2 writer-incr-level メソッド</a></li>
<li class='tocx'><a href='#fFHRToz0LBB'>3.35.1.3 writer-decr-level メソッド</a></li>
<li class='tocx'><a href='#27c0tsawNaI'>3.35.1.4 writer-close メソッド</a></li>
</blockquote>
</details>
<li class='tocx'><a href='#b2iyvLVaRzT'>3.35.2 create-svg-writer 関数</a></li>
</blockquote>
</details>
</blockquote>
</details>
<li class='tocx'><a href='#1ewHzjI62xn'>4 索引</a></li>
<p>　　</p>
<h2><a name='iUs1vEgM0gr'></a>2 概念</h2>
<h3><a name='a6YbzgTm8yY'></a>2.1 座標系</h3>
<p>　<a class='autolink' href='#2xCCaUuNLlH'>diagram</a> の座標系は、左上を原点としています。そこから水平右方向に x 軸、垂直下方向に y 軸です。角度は時計回りになります。</p>
<div align='center'>
<?xml version='1.0' encoding='utf-8' ?>
<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' baseProfile='full' xml:space='default' width='300' height='100'>
	
	<!-- grid -->
	<pattern id='__grid' width='10' height='10' patternUnits='userSpaceOnUse' >
		<rect x='0' y='0' width='10' height='10' fill='white' />
		<polyline fill='none' stroke='gray' stroke-width='0.2' points='10,0 0,0 0,10' />
	</pattern>
	<rect x='0' y='0' width='100%' height='100%' fill='url(#__grid)' stroke='gray' stroke-width='0.2' />
	<!-- circle -->
	<circle cx='0' cy='0' r='3' fill='red' stroke='none' stroke-width='1' />
	<!-- text -->
	<text x='5' y='15' text-anchor='start' font-size='12pt' fill='black' >(0 0)</text>
	<!-- text -->
	<text x='260' y='15' text-anchor='start' font-size='12pt' fill='black' >→ x</text>
	<!-- text -->
	<text x='5' y='90' text-anchor='start' font-size='12pt' fill='black' >↓ y</text>
	<!-- line -->
	<polyline fill='none' stroke='gray' stroke-width='1' points=' 100.0,30.0 150.0,30.0' />
	<!-- line -->
	<polyline fill='none' stroke='gray' stroke-width='1' points=' 100.0,30.0 120.0,80.0' />
	<!-- arc -->
	<path fill='none' stroke='black' stroke-width='1' d='M 140.0 30.0 A 40 40 0 0 1 114.98426373663648 67.0873541826715' />
	<!-- line -->
	<polyline fill='none' stroke='black' stroke-width='1' points=' 115.0,67.0 118.0,61.0' />
	<!-- line -->
	<polyline fill='none' stroke='black' stroke-width='1' points=' 115.0,67.0 122.0,67.0' />
	<!-- text -->
	<text x='140' y='60' text-anchor='start' font-size='12pt' fill='black' >θ</text>

</svg>
</div>

<h3><a name='jXsxcbXYkll'></a>2.2 キャンバス</h3>
<p>　<a class='autolink' href='#2xCCaUuNLlH'>diagram</a> における<a class='autolink' href='#jXsxcbXYkll'>キャンバス</a>とは、点 <code>top-left</code> と幅、高さを持つ矩形です。</p>
<p>　<span style='background:red;color:white;'>ToDo : サブキャンバスなどについても説明しないと</span></p>
<h3><a name='hQqTfTkbNyq'></a>2.3 エンティティ</h3>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません</span></p>
<h3><a name='hv2FXS6j5gn'></a>2.4 ディクショナリ</h3>
<p>　<a class='autolink' href='#hv2FXS6j5gn'>ディクショナリ</a>は、<a class='autolink' href='#hQqTfTkbNyq'>エンティティ</a>を ID で管理するためのクラスです。また、$1 などの履歴でアクセスするための履歴機能も提供します。</p>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません</span></p>
<h3><a name='1rpUB3fre67'></a>2.5 色の指定</h3>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません</span></p>
<h2><a name='bzrfEUL5NBz'></a>3 src 配下のコンポーネント</h2>
<h3><a name='5PHdXU1SAwU'></a>3.1 arc.lisp</h3>
<p>　<a class='autolink' href='#5PHdXU1SAwU'>arc.lisp</a> は以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
<li><a class='autolink' href='#g7U0GGx7sCV'>point.lisp</a></li>
<li><a class='autolink' href='#jkshMjTfNSO'>canvas.lisp</a></li>
<li><a class='autolink' href='#0uaBbu9jd7a'>mathutil.lisp</a></li>
<li><a class='autolink' href='#9k30aVu2Utl'>path.lisp</a></li>
</ul>
<h3><a name='jRts0Y6YUfH'></a>3.2 binutil.lisp</h3>
<p>　<a class='autolink' href='#jRts0Y6YUfH'>binutil.lisp</a> は以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
</ul>
<h3><a name='jkshMjTfNSO'></a>3.3 canvas.lisp</h3>
<p>　<a class='autolink' href='#jkshMjTfNSO'>canvas.lisp</a> は<a class='autolink' href='#jXsxcbXYkll'>キャンバス</a>を実装します。以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
<li><a class='autolink' href='#g7U0GGx7sCV'>point.lisp</a></li>
</ul>
<h4><a name='92zJ4HjAUik'></a>3.3.1 make-canvas 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>make-canvas</span> (top-left width height) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='cTwJaoEIPT1'></a>3.3.2 copy-canvas 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>copy-canvas</span> (canvas) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='1HAaPkwx2sJ'></a>3.3.3 canvas-p 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>canvas-p</span> (canvas) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='efXUIZFt7c7'></a>3.3.4 canvas-topleft 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>canvas-topleft</span> (canvas) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='cSuiLry4j2n'></a>3.3.5 canvas-left 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>canvas-left</span>    (canvas) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<!-- (defun (setf canvas-left) (val canvas) -->
<h4><a name='6vlqkJUhc5s'></a>3.3.6 canvas-top 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>canvas-top</span>     (canvas) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<!-- (defun (setf canvas-top)  (val canvas) -->
<h4><a name='fM6z1S2PXli'></a>3.3.7 canvas-right 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>canvas-right</span>   (canvas) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='3KzHqSMKOM6'></a>3.3.8 canvas-bottom 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>canvas-bottom</span>  (canvas) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='kz1CArkN4MX'></a>3.3.9 canvas-width 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>canvas-width</span>  (canvas) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<!-- (defun (setf canvas-width)  (val canvas) -->
<h4><a name='gl7uceIWuvQ'></a>3.3.10 canvas-height 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>canvas-height</span> (canvas) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<!-- (defun (setf canvas-height) (val canvas) -->
<h4><a name='5zrSjOXYv2S'></a>3.3.11 canvas-fix-point 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>canvas-fix-point</span> (canvas pt) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='8SwZig7eicm'></a>3.3.12 with-canvas マクロ</h4>
<pre class='code'>
(<span class='keyword1'>defmacro</span> <span class='keyword5'>with-canvas</span> ((sym-topleft sym-width sym-height) canvas <span class='keyword2'>&amp;rest</span> body) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='a48ATArhBUk'></a>3.3.13 with-subcanvas マクロ</h4>
<pre class='code'>
(<span class='keyword1'>defmacro</span> <span class='keyword5'>with-subcanvas</span> ((top-left width height) <span class='keyword2'>&amp;rest</span> body) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='5r9jjHGdPUD'></a>3.3.14 canvas-dict-width 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>canvas-dict-width</span> (canvas) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='42betqaDwBK'></a>3.3.15 canvas-dict-height 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>canvas-dict-height</span> (canvas) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='g1qrFI5J49t'></a>3.3.16 canvas-dict-topleft 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>canvas-dict-topleft</span> (canvas) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='6LB76PkdkZJ'></a>3.3.17 canvas-dict-top 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>canvas-dict-top</span> (canvas) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='dHAbaoBcL3P'></a>3.3.18 canvas-dict-topright 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>canvas-dict-topright</span> (canvas) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='jY1KoLc5Ygu'></a>3.3.19 canvas-dict-left 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>canvas-dict-left</span> (canvas) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='jbqMd3uQuTg'></a>3.3.20 canvas-dict-center 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>canvas-dict-center</span> (canvas) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='8QTTuc8dfLe'></a>3.3.21 canvas-dict-right 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>canvas-dict-right</span> (canvas) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='iyqoOBS1Fx2'></a>3.3.22 canvas-dict-bottomleft 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>canvas-dict-bottomleft</span> (canvas) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='g2Q4C1SxBla'></a>3.3.23 canvas-dict-bottom 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>canvas-dict-bottom</span> (canvas) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='6sY8VX3mC8y'></a>3.3.24 canvas-dict-bottomright 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>canvas-dict-bottomright</span> (canvas) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h3><a name='0vu6jIAdrHn'></a>3.4 circle.lisp</h3>
<p>　<a class='autolink' href='#0vu6jIAdrHn'>circle.lisp</a> は以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
<li><a class='autolink' href='#3c2PhHDsO5I'>constants.lisp</a></li>
<li><a class='autolink' href='#0uaBbu9jd7a'>mathutil.lisp</a></li>
<li><a class='autolink' href='#jkshMjTfNSO'>canvas.lisp</a></li>
<li><a class='autolink' href='#g7U0GGx7sCV'>point.lisp</a></li>
<li><a class='autolink' href='#jzen8zyw08N'>shape.lisp</a></li>
<li><a class='autolink' href='#5S5mEI6PrDL'>stroke-info.lisp</a></li>
<li><a class='autolink' href='#k0U5yutENit'>link-info.lisp</a></li>
<li><a class='autolink' href='#7NkNOcI9zDh'>writer.lisp</a></li>
</ul>
<h3><a name='6qK0TBix0mp'></a>3.5 cl-diagram.lisp</h3>
<p>　<a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a> は他のコンポーネントには依存していません。</p>
<h4><a name='dQph0tOdHQ4'></a>3.5.1 string/mid 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>string/mid</span> (str idx <span class='keyword2'>&amp;optional</span> (len -1)) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='dS6SufHR3Ix'></a>3.5.2 string/replace 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>string/replace</span> (target str1 str2) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='gtO8775YqBc'></a>3.5.3 string/split 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>string/split</span> (line separator) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='fO1t1ED8A9I'></a>3.5.4 onlisp/mkstr 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>onlisp/mkstr</span> (<span class='keyword2'>&amp;rest</span> args) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='kGO3CobDdFK'></a>3.5.5 onlisp/symb 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>onlisp/symb</span> (<span class='keyword2'>&amp;rest</span> args) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='amdyJtzHvGs'></a>3.5.6 onlisp/keysymb 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>onlisp/keysymb</span> (<span class='keyword2'>&amp;rest</span> args) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='8P16jLcfrTL'></a>3.5.7 onlisp/flatten 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>onlisp/flatten</span> (x <span class='keyword2'>&amp;optional</span> (acc nil)) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='8bLRXqBRaO7'></a>3.5.8 fix-name 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>fix-name</span> (name <span class='keyword2'>&amp;optional</span> no-multiline) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='aILr24BuzyN'></a>3.5.9 __write-imp 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>__write-imp</span> (stream itm) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='8n4YMx0lEny'></a>3.5.10 exception コンディション</h4>
<pre class='code'>
(<span class='keyword1'>define-condition</span> exception (cl:<span class='keyword1'>error</span>) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='kiT1zMbnS1G'></a>3.5.11 caution コンディション</h4>
<pre class='code'>
(<span class='keyword1'>define-condition</span> caution (cl:warning) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='hKajqxDpSVa'></a>3.5.12 throw-exception マクロ</h4>
<pre class='code'>
(<span class='keyword1'>defmacro</span> <span class='keyword5'>throw-exception</span> (fmt <span class='keyword2'>&amp;rest</span> args) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='g7f5yssQwTG'></a>3.5.13 throw-caution マクロ</h4>
<pre class='code'>
(<span class='keyword1'>defmacro</span> <span class='keyword5'>throw-caution</span> (fmt <span class='keyword2'>&amp;rest</span> args) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='4MzkIlZeOig'></a>3.5.14 type-assert マクロ</h4>
<pre class='code'>
(<span class='keyword1'>defmacro</span> <span class='keyword5'>type-assert</span> (symbol type) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='9c7EgdLRM3i'></a>3.5.15 chk-type マクロ</h4>
<pre class='code'>
(<span class='keyword1'>defmacro</span> <span class='keyword5'>chk-type</span> (symbol type <span class='keyword2'>&amp;optional</span> (name nil)) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='ctyQaetTK05'></a>3.5.16 format-string 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>format-string</span> (<span class='keyword2'>&amp;rest</span> args) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='4agHkkJhiI1'></a>3.5.17 check-member マクロ</h4>
<pre class='code'>
(<span class='keyword1'>defmacro</span> <span class='keyword5'>check-member</span> (sym <span class='keyword2'>&amp;key</span> (nullable nil) (types nil)) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='8UPDTpCxfvu'></a>3.5.18 check-object マクロ</h4>
<pre class='code'>
(<span class='keyword1'>defmacro</span> <span class='keyword5'>check-object</span> (sym canvas dict <span class='keyword2'>&amp;key</span> (nullable nil) (class nil)) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='byoOCbZmVzI'></a>3.5.19 check-keywords マクロ</h4>
<pre class='code'>
(<span class='keyword1'>defmacro</span> <span class='keyword5'>check-keywords</span> (sym <span class='keyword2'>&amp;rest</span> choices) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='7OeiJB9pyPw'></a>3.5.20 check-numbers マクロ</h4>
<pre class='code'>
(<span class='keyword1'>defmacro</span> <span class='keyword5'>check-numbers</span> (sym <span class='keyword2'>&amp;rest</span> choices) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='banMcDxF6dd'></a>3.5.21 write-when マクロ</h4>
<pre class='code'>
(<span class='keyword1'>defmacro</span> <span class='keyword5'>write-when</span> (item <span class='keyword2'>&amp;rest</span> args) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='k9ex0jPxy6W'></a>3.5.22 with-dictionary マクロ</h4>
<pre class='code'>
(<span class='keyword1'>defmacro</span> <span class='keyword5'>with-dictionary</span> (dict <span class='keyword2'>&amp;rest</span> body) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='koEWNsjRkGS'></a>3.5.23 escape-characters 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>escape-characters</span> (str) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='kWO3U8sB5EC'></a>3.5.24 to-property-strings 総称関数</h4>
<pre class='code'>
(<span class='keyword1'>defgeneric</span> <span class='keyword5'>to-property-strings</span> (info))
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='6KE7wGjrGwN'></a>3.5.25 to-style-strings 総称関数</h4>
<pre class='code'>
(<span class='keyword1'>defgeneric</span> <span class='keyword5'>to-style-strings</span> (info))
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='dam9QmgaZrq'></a>3.5.26 check 総称関数</h4>
<pre class='code'>
(<span class='keyword1'>defgeneric</span> <span class='keyword5'>check</span> (obj canvas dict))
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='7QraN5WNGea'></a>3.5.27 rgb 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>rgb</span> (r g b) ... )
</pre>
<p>　R, G, B の各色要素の値を 0 - 255 で与えることにより、`#RRGGBB` 形式の文字列を生成します。以下に例を示します。</p>
<pre class='code'>
(diagram:rgb 10 20 30)
<span class='comment'>; =&gt; "#0A141E"</span>
</pre>
<h3><a name='gjxTJAKDoPj'></a>3.6 connector.lisp</h3>
<p>　<a class='autolink' href='#gjxTJAKDoPj'>connector.lisp</a> は以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
<li><a class='autolink' href='#3c2PhHDsO5I'>constants.lisp</a></li>
<li><a class='autolink' href='#kCVvdOT2S7L'>dictionary.lisp</a></li>
<li><a class='autolink' href='#7Y5KOwJXVqF'>line.lisp</a></li>
<li><a class='autolink' href='#c1IDRaD20g3'>rectangle.lisp</a></li>
<li><a class='autolink' href='#jzen8zyw08N'>shape.lisp</a></li>
<li><a class='autolink' href='#7NkNOcI9zDh'>writer.lisp</a></li>
</ul>
<h3><a name='3c2PhHDsO5I'></a>3.7 constants.lisp</h3>
<p>　<a class='autolink' href='#3c2PhHDsO5I'>constants.lisp</a> は以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
</ul>
<h3><a name='jCwDkKC4S8s'></a>3.8 create-svg.lisp</h3>
<p>　<a class='autolink' href='#jCwDkKC4S8s'>create-svg.lisp</a> は以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
<li><a class='autolink' href='#3c2PhHDsO5I'>constants.lisp</a></li>
<li><a class='autolink' href='#h05k6V1sTsF'>entity.lisp</a></li>
<li><a class='autolink' href='#g6PVqK0GAdf'>layer-manager.lisp</a></li>
<li><a class='autolink' href='#kCVvdOT2S7L'>dictionary.lisp</a></li>
<li><a class='autolink' href='#g7U0GGx7sCV'>point.lisp</a></li>
<li><a class='autolink' href='#jkshMjTfNSO'>canvas.lisp</a></li>
<li><a class='autolink' href='#l9bqLva3rj6'>font-info.lisp</a></li>
<li><a class='autolink' href='#5S5mEI6PrDL'>stroke-info.lisp</a></li>
<li><a class='autolink' href='#7NkNOcI9zDh'>writer.lisp</a></li>
</ul>
<h4><a name='bpd2tQ1LZ9f'></a>3.8.1 create-svg マクロ</h4>
<pre class='code'>
(<span class='keyword1'>defmacro</span> <span class='keyword5'>create-svg</span> ((<span class='keyword2'>&amp;key</span> width height desc) <span class='keyword2'>&amp;rest</span> body) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h4><a name='2xCCaUuNLlH'></a>3.8.2 diagram マクロ</h4>
<pre class='code'>
(<span class='keyword1'>defmacro</span> <span class='keyword5'>diagram</span> ((<span class='keyword2'>&amp;key</span> w h) <span class='keyword2'>&amp;rest</span> body) ... )
</pre>
<p>　<span style='background:red;color:white;'>ToDo : まだ記述されていません。</span></p>
<h3><a name='kCVvdOT2S7L'></a>3.9 dictionary.lisp</h3>
<p>　<a class='autolink' href='#kCVvdOT2S7L'>dictionary.lisp</a> は、<a class='autolink' href='#hv2FXS6j5gn'>ディクショナリ</a>機能を実装します。以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
</ul>
<h4><a name='8sXKk1Q8d2H'></a>3.9.1 dictionary クラス</h4>
<pre class='code'>
(<span class='keyword1'>defclass</span> <span class='keyword2'>dictionary</span> ()
  ((history-max  <span class='keyword3'>:initform</span>   0 <span class='keyword3'>:initarg</span> <span class='keyword3'>:hist-max</span>)   <span class='comment'>; integer</span>
   (history-top  <span class='keyword3'>:initform</span>   0 <span class='keyword3'>:initarg</span> <span class='keyword3'>:hist-top</span>)   <span class='comment'>; list</span>
   (history-size <span class='keyword3'>:initform</span>   0 <span class='keyword3'>:initarg</span> <span class='keyword3'>:hist-size</span>)  <span class='comment'>; integer</span>
   (map          <span class='keyword3'>:initform</span> nil <span class='keyword3'>:initarg</span> <span class='keyword3'>:map</span>)))      <span class='comment'>; hashtable</span>
</pre>
<p>　基本的には、キーワードシンボルをキーとする hashtable で管理されます。 <code>history-*</code> メンバは履歴機能のためのもので、 <code>history-top</code> が <code>entity</code> のリストを保有します。 <code>history-size</code> がリストの現在のサイズを保持しており、これが <code>history-max</code> を超えないように制御されます。</p>
<h4><a name='6XTh8JnAh0Q'></a>3.9.2 dict-create 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>dict-create</span> (history-max-count) ... )
</pre>
<p>　<code>dictionary</code> のインスタンスを新規に作成して返します。履歴機能で保有する最大数をパラメータとして受け取ります。これは後から変更することはできません。</p>
<h4><a name='1X7zDLB8Dho'></a>3.9.3 dict-register 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>dict-register</span> (dict entity) ... )
</pre>
<p>　<code>dictionary</code> のインスタンス <code>dict</code> に <code>entity</code> を登録します。 <code>entity</code> に <code>id</code> が指定されていない場合、履歴には追加されますが<a class='autolink' href='#hv2FXS6j5gn'>ディクショナリ</a>登録はされません。</p>
<h4><a name='ihOjTTad5LY'></a>3.9.4 dict-get-entity 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>dict-get-entity</span> (dict id) ... )
</pre>
<p>　指定した <code>id</code> の <code>entity</code> を<a class='autolink' href='#hv2FXS6j5gn'>ディクショナリ</a>、または履歴から探して返します。</p>
<p>　<code>id</code> が $1 などの履歴を示すシンボルの場合、履歴から<a class='autolink' href='#hQqTfTkbNyq'>エンティティ</a>を探します。そうでない場合、ID でハッシュテーブルを検索し、みつけた<a class='autolink' href='#hQqTfTkbNyq'>エンティティ</a>を返します。</p>
<h3><a name='hd7ThdvzqQq'></a>3.10 ellipse.lisp</h3>
<p>　<a class='autolink' href='#hd7ThdvzqQq'>ellipse.lisp</a> は以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
<li><a class='autolink' href='#3c2PhHDsO5I'>constants.lisp</a></li>
<li><a class='autolink' href='#jkshMjTfNSO'>canvas.lisp</a></li>
<li><a class='autolink' href='#g7U0GGx7sCV'>point.lisp</a></li>
<li><a class='autolink' href='#jzen8zyw08N'>shape.lisp</a></li>
<li><a class='autolink' href='#5S5mEI6PrDL'>stroke-info.lisp</a></li>
<li><a class='autolink' href='#k0U5yutENit'>link-info.lisp</a></li>
<li><a class='autolink' href='#7NkNOcI9zDh'>writer.lisp</a></li>
</ul>
<h3><a name='4V2uI4HhR9d'></a>3.11 endmark-info.lisp</h3>
<p>　<a class='autolink' href='#4V2uI4HhR9d'>endmark-info.lisp</a> は以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
<li><a class='autolink' href='#3c2PhHDsO5I'>constants.lisp</a></li>
<li><a class='autolink' href='#0uaBbu9jd7a'>mathutil.lisp</a></li>
<li><a class='autolink' href='#g7U0GGx7sCV'>point.lisp</a></li>
<li><a class='autolink' href='#jkshMjTfNSO'>canvas.lisp</a></li>
<li><a class='autolink' href='#kCVvdOT2S7L'>dictionary.lisp</a></li>
<li><a class='autolink' href='#au8IebMfeov'>fill-info.lisp</a></li>
<li><a class='autolink' href='#5S5mEI6PrDL'>stroke-info.lisp</a></li>
<li><a class='autolink' href='#7NkNOcI9zDh'>writer.lisp</a></li>
</ul>
<h3><a name='h05k6V1sTsF'></a>3.12 entity.lisp</h3>
<p>　<a class='autolink' href='#h05k6V1sTsF'>entity.lisp</a> は、<a class='autolink' href='#hQqTfTkbNyq'>エンティティ</a>を実装します。以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
<li><a class='autolink' href='#jkshMjTfNSO'>canvas.lisp</a></li>
<li><a class='autolink' href='#7NkNOcI9zDh'>writer.lisp</a></li>
</ul>
<h4><a name='coMfaBWu7eG'></a>3.12.1 entity クラス</h4>
<p>　<a class='autolink' href='#coMfaBWu7eG'>entity</a> は id と layer を保持します。どちらもキーワードシンボルとしての保有で、nil が許可されます。</p>
<pre class='code'>
(<span class='keyword1'>defclass</span> <span class='keyword2'>entity</span> ()
  ((id    <span class='keyword3'>:initform</span> nil <span class='keyword3'>:initarg</span> <span class='keyword3'>:id</span>)       <span class='comment'>; keyword</span>
   (layer <span class='keyword3'>:initform</span> nil <span class='keyword3'>:initarg</span> <span class='keyword3'>:layer</span>)))  <span class='comment'>; keyword</span>
</pre>
<div align='center'>
<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="97px" preserveAspectRatio="none" style="width:124px;height:97px;background:#FFFFFF;" version="1.1" viewBox="0 0 124 97" width="124px" zoomAndPan="magnify"><defs/><g><!--MD5=[467568f20bbf29da492dca29e9e0779e]
class entity--><g id="elem_entity"><rect codeLine="1" fill="#F1F1F1" height="76" id="entity" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="103" x="7" y="7"/><ellipse cx="37.3" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M40.6906,24.9844 Q40.2688,29.9688 36.9563,29.9688 Q35.0031,29.9688 33.9563,27.9688 Q33.0813,26.2969 33.0813,23.3594 Q33.0813,20.3438 34.05,18.5781 Q35.05,16.7031 36.9563,16.7031 Q39.9875,16.7031 40.6125,21.1406 L38.5344,21.1406 Q38.175,18.6719 36.9563,18.6719 Q35.2219,18.6719 35.2219,23.3594 Q35.2219,28 36.9719,28 Q38.4094,28 38.5656,24.9844 L40.6906,24.9844 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37" x="54.7" y="28.3184">entity</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="109" y1="39" y2="39"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="13" y="55.3184">keyword id</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="13" y="69.3184">keyword layer</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="109" y1="75" y2="75"/></g><!--MD5=[a89970daaa15df8120fafadecd0b98df]
@startuml
class entity {
  keyword id
  keyword layer
}
@enduml

PlantUML version 1.2022.5(Sat Apr 30 19:55:52 JST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: ja
Country: JP
--></g></svg></div>

<h4><a name='h7eqOL9fNA4'></a>3.12.2 begin-id-group 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>begin-id-group</span> (ent writer) ... )
</pre>
<p>　id を持つ<a class='autolink' href='#hQqTfTkbNyq'>エンティティ</a>の場合、svg 出力において id を指定した g タグで全体を括るための関数です。デフォルト実装では <a class='autolink' href='#aOXIgO3wNWv'>pre-draw</a> 総称関数の実装からコールされます。</p>
<h4><a name='bFrl4dwpxKu'></a>3.12.3 end-id-group 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>end-id-group</span> (ent writer) ... )
</pre>
<p>　id を持つ<a class='autolink' href='#hQqTfTkbNyq'>エンティティ</a>の場合、svg 出力において id を指定した g タグを閉じるための関数です。デフォルト実装では <a class='autolink' href='#9lFMWTnv8EC'>post-draw</a> 総称関数の実装からコールされます。</p>
<h4><a name='dBxV4D4cAYB'></a>3.12.4 entity-composition-p 総称関数</h4>
<pre class='code'>
(<span class='keyword1'>defgeneric</span> <span class='keyword5'>entity-composition-p</span> (ent)) ... )
</pre>
<p>　<a class='autolink' href='#hQqTfTkbNyq'>エンティティ</a>が複合オブジェクトであるか否かを調べるための総称関数です。<a class='autolink' href='#coMfaBWu7eG'>entity</a> に対する実装では nil を返します。</p>
<h4><a name='3ffyzBxLMJk'></a>3.12.5 write-header 総称関数</h4>
<pre class='code'>
(<span class='keyword1'>defgeneric</span> <span class='keyword5'>write-header</span> (entity writer)) ... )
</pre>
<p>　<a class='autolink' href='#hQqTfTkbNyq'>エンティティ</a>の svg コードを出力前にヘッダコメントを出力するための総称関数です。</p>
<h4><a name='aOXIgO3wNWv'></a>3.12.6 pre-draw 総称関数</h4>
<pre class='code'>
(<span class='keyword1'>defgeneric</span> <span class='keyword5'>pre-draw</span> (entity writer)) ... )
</pre>
<p>　<a class='autolink' href='#hQqTfTkbNyq'>エンティティ</a>の svg コードを出力する <a class='autolink' href='#eRs3IQibPlS'>draw-entity</a> 総称関数の実装の冒頭でコールされることを想定した総称関数です。<a class='autolink' href='#coMfaBWu7eG'>entity</a> に対するデフォルト実装では、複合<a class='autolink' href='#hQqTfTkbNyq'>エンティティ</a>であった場合に<a class='autolink' href='#h7eqOL9fNA4'>begin-id-group</a> 関数をコールします。</p>
<h4><a name='9lFMWTnv8EC'></a>3.12.7 post-draw 総称関数</h4>
<pre class='code'>
(<span class='keyword1'>defgeneric</span> <span class='keyword5'>post-draw</span> (entity writer)) ... )
</pre>
<p>　<a class='autolink' href='#hQqTfTkbNyq'>エンティティ</a>の svg コードを出力する <a class='autolink' href='#eRs3IQibPlS'>draw-entity</a> 総称関数の実装の最後にコールされることを想定した総称関数です。<a class='autolink' href='#coMfaBWu7eG'>entity</a> に対するデフォルト実装では、複合<a class='autolink' href='#hQqTfTkbNyq'>エンティティ</a>であった場合に<a class='autolink' href='#bFrl4dwpxKu'>end-id-group</a> 関数をコールします。</p>
<h4><a name='eRs3IQibPlS'></a>3.12.8 draw-entity 総称関数</h4>
<pre class='code'>
(<span class='keyword1'>defgeneric</span> <span class='keyword5'>draw-entity</span> (entity writer)) ... )
</pre>
<p>　<a class='autolink' href='#hQqTfTkbNyq'>エンティティ</a>の svg コードを出力するための総称関数です。<a class='autolink' href='#coMfaBWu7eG'>entity</a> に対する実装は存在しません。派生クラスで必ず実装してください。</p>
<h4><a name='kXeJPcGPcpP'></a>3.12.9 check-and-draw-local-entity 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>check-and-draw-local-entity</span> (entity canvas writer) ... )
</pre>
<p>　<a class='autolink' href='#8sXKk1Q8d2H'>dictionary</a> に登録されないローカルな <a class='autolink' href='#coMfaBWu7eG'>entity</a> を描画するための関数です。確認されている利用個所としては以下があります。</p>
<ul>
<li><a class='autolink' href='#dxGh4wRHKeg'>group.lisp</a> - draw-canvas-frame 関数</li>
<li><a class='autolink' href='#kNkTqs2VjiA'>text-shape.lisp</a> - draw-group メソッド</li>
</ul>
<h3><a name='au8IebMfeov'></a>3.13 fill-info.lisp</h3>
<p>　<a class='autolink' href='#au8IebMfeov'>fill-info.lisp</a> は塗り潰しの指定を表現するクラスです。以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
</ul>
<h4><a name='g99vlb6tXRZ'></a>3.13.1 *default-fill*変数</h4>
<pre class='code'>
(<span class='keyword1'>defparameter</span> <span class='keyword4'>*default-fill*</span> nil)
</pre>
<p>　デフォルトの塗り潰しを表現するダイナミック変数です。初期状態では<code>(make-fill :color :none :opacity nil :rule nil)</code> の結果が設定されます。</p>
<h4><a name='fDv1lctqo7i'></a>3.13.2 fill-info クラス</h4>
<p>　<a class='autolink' href='#fDv1lctqo7i'>fill-info</a> は color、opacity、rule を保持します。いずれも nil が許可されます。</p>
<pre class='code'>
(<span class='keyword1'>defclass</span> <span class='keyword2'>fill-info</span> ()
  ((color   <span class='keyword3'>:initform</span> nil <span class='keyword3'>:initarg</span> <span class='keyword3'>:color</span>)    <span class='comment'>; (or keyword string)</span>
   (opacity <span class='keyword3'>:initform</span> nil <span class='keyword3'>:initarg</span> <span class='keyword3'>:opacity</span>)  <span class='comment'>; number</span>
   (rule    <span class='keyword3'>:initform</span> nil <span class='keyword3'>:initarg</span> <span class='keyword3'>:rule</span>)))   <span class='comment'>; (or nil keyword)</span>
</pre>
<p>　<a class='autolink' href='#fDv1lctqo7i'>fill-info</a> クラス向けに、以下の総称関数のメソッドが実装されています。</p>
<ul>
<li>initialize-instance </li>
<li><a class='autolink' href='#dam9QmgaZrq'>check</a> </li>
<li><a class='autolink' href='#kWO3U8sB5EC'>to-property-strings</a></li>
<li><a class='autolink' href='#6KE7wGjrGwN'>to-style-strings</a></li>
</ul>
<h4><a name='8IkB7VinE7h'></a>3.13.3 make-fill 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>make-fill</span> (<span class='keyword2'>&amp;rest</span> params) ... )
</pre>
<p>　<a class='autolink' href='#fDv1lctqo7i'>fill-info</a> インスタンスを作成します。パラメータの数や種類に応じて作り方が異なります。</p>
<ul>
<li>パラメータ無しの場合、 <code>*default-fill*</code> を返します</li>
<li>パラメータ数が 1 の場合、そのパラメータを param として
<ul>
<li>param が <a class='autolink' href='#fDv1lctqo7i'>fill-info</a> インスタンスの場合、渡されたものをそのまま返します</li>
<li>param がリストの場合、 <code>(apply #'make-fill param)</code> の結果を返します</li>
<li>上記のいずれでもない場合、 <code>(make-fill :color param)</code> の結果を返します</li>
</ul>
</li>
<li>パラメータ数が 2 以上の場合、以下の関数のように振舞います。
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>make-fill</span> (<span class='keyword2'>&amp;key</span> color opacity rule base) ... )
</pre>
<ul>
<li><code>base</code> はその他のパラメータが省略された場合にデフォルト値を取得するための <code>fill-info</code> インスタンスで、これが省略された場合は <code>*default-fill*</code> が使用されます。</li>
<li><code>color</code> は<a class='autolink' href='#1rpUB3fre67'>色の指定</a>です。指定方法の詳細は「<a class='autolink' href='#1rpUB3fre67'>色の指定</a>」を参照してください。</li>
<li><code>opacity</code> で透明度を指定します。0 から 1 までの浮動小数点数で指定します。</li>
<li><code>rule</code> は塗りつぶしに関するルールです。 <code>:nonzero</code> または <code>:evenodd</code> で指定します。</li>
</ul>
</li>
</ul>
<h4><a name='apbktIICmZP'></a>3.13.4 with-fill マクロ</h4>
<pre class='code'>
(<span class='keyword1'>defmacro</span> <span class='keyword5'>with-fill</span> ((<span class='keyword2'>&amp;rest</span> param) <span class='keyword2'>&amp;rest</span> body) ... )
</pre>
<p>　<code>*default-fill*</code> を一時的に変更します。 <code>params</code> には <a class='autolink' href='#8IkB7VinE7h'>make-fill</a> に与えるパラメータと同じものを指定します。以下のコードは、</p>
<pre class='code'>
(with-fill (<span class='keyword3'>:color</span> <span class='keyword3'>:red</span> <span class='keyword3'>:opacity</span> 0.2)
   ... )
</pre>
<p>　以下と同等です。</p>
<pre class='code'>
(<span class='keyword1'>let</span> ((*default-fill* (make-fill <span class='keyword3'>:color</span> <span class='keyword3'>:red</span> <span class='keyword3'>:opacity</span> 0.2)))
   ... )
</pre>
<h3><a name='l9bqLva3rj6'></a>3.14 font-info.lisp</h3>
<p>　<a class='autolink' href='#l9bqLva3rj6'>font-info.lisp</a> は以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
<li><a class='autolink' href='#au8IebMfeov'>fill-info.lisp</a></li>
<li><a class='autolink' href='#5S5mEI6PrDL'>stroke-info.lisp</a></li>
</ul>
<h3><a name='dxGh4wRHKeg'></a>3.15 group.lisp</h3>
<p>　<a class='autolink' href='#dxGh4wRHKeg'>group.lisp</a> は以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
<li><a class='autolink' href='#jkshMjTfNSO'>canvas.lisp</a></li>
<li><a class='autolink' href='#jzen8zyw08N'>shape.lisp</a></li>
<li><a class='autolink' href='#7NkNOcI9zDh'>writer.lisp</a></li>
</ul>
<h3><a name='4ukAyTPlA3e'></a>3.16 image.lisp</h3>
<p>　<a class='autolink' href='#4ukAyTPlA3e'>image.lisp</a> は以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
<li><a class='autolink' href='#jRts0Y6YUfH'>binutil.lisp</a></li>
<li><a class='autolink' href='#jzen8zyw08N'>shape.lisp</a></li>
<li><a class='autolink' href='#hNccIQgX3H4'>label-info.lisp</a></li>
<li><a class='autolink' href='#k0U5yutENit'>link-info.lisp</a></li>
<li><a class='autolink' href='#g7U0GGx7sCV'>point.lisp</a></li>
<li><a class='autolink' href='#7NkNOcI9zDh'>writer.lisp</a></li>
</ul>
<h3><a name='hNccIQgX3H4'></a>3.17 label-info.lisp</h3>
<p>　<a class='autolink' href='#hNccIQgX3H4'>label-info.lisp</a> は以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
<li><a class='autolink' href='#3c2PhHDsO5I'>constants.lisp</a></li>
<li><a class='autolink' href='#g7U0GGx7sCV'>point.lisp</a></li>
<li><a class='autolink' href='#jkshMjTfNSO'>canvas.lisp</a></li>
<li><a class='autolink' href='#l9bqLva3rj6'>font-info.lisp</a></li>
<li><a class='autolink' href='#jzen8zyw08N'>shape.lisp</a></li>
<li><a class='autolink' href='#7NkNOcI9zDh'>writer.lisp</a></li>
</ul>
<h3><a name='g6PVqK0GAdf'></a>3.18 layer-manager.lisp</h3>
<p>　<a class='autolink' href='#g6PVqK0GAdf'>layer-manager.lisp</a> は以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
<li><a class='autolink' href='#7NkNOcI9zDh'>writer.lisp</a></li>
</ul>
<h3><a name='7Y5KOwJXVqF'></a>3.19 line.lisp</h3>
<p>　<a class='autolink' href='#7Y5KOwJXVqF'>line.lisp</a> は以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
<li><a class='autolink' href='#3c2PhHDsO5I'>constants.lisp</a></li>
<li><a class='autolink' href='#g7U0GGx7sCV'>point.lisp</a></li>
<li><a class='autolink' href='#0uaBbu9jd7a'>mathutil.lisp</a></li>
<li><a class='autolink' href='#hNccIQgX3H4'>label-info.lisp</a></li>
<li><a class='autolink' href='#5S5mEI6PrDL'>stroke-info.lisp</a></li>
<li><a class='autolink' href='#4V2uI4HhR9d'>endmark-info.lisp</a></li>
<li><a class='autolink' href='#h05k6V1sTsF'>entity.lisp</a></li>
<li><a class='autolink' href='#7NkNOcI9zDh'>writer.lisp</a></li>
</ul>
<h3><a name='k0U5yutENit'></a>3.20 link-info.lisp</h3>
<p>　<a class='autolink' href='#k0U5yutENit'>link-info.lisp</a> は以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
<li><a class='autolink' href='#3c2PhHDsO5I'>constants.lisp</a></li>
<li><a class='autolink' href='#7NkNOcI9zDh'>writer.lisp</a></li>
</ul>
<div align='center'>
<?xml version='1.0' encoding='utf-8' ?>
<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' baseProfile='full' xml:space='default' width='300' height='100'>
	
	<!-- grid -->
	<pattern id='__grid' width='10' height='10' patternUnits='userSpaceOnUse' >
		<rect x='0' y='0' width='10' height='10' fill='white' />
		<polyline fill='none' stroke='gray' stroke-width='0.2' points='10,0 0,0 0,10' />
	</pattern>
	<rect x='0' y='0' width='100%' height='100%' fill='url(#__grid)' stroke='gray' stroke-width='0.2' />
	<!-- rectangle -->
	<a xlink:href='http://www.google.co.jp/' target='_blank'>
		<rect x='85' y='35' width='30' height='30' fill='lightgray' stroke='black' stroke-width='1' />
	</a>

</svg>
</div>

<h3><a name='0uaBbu9jd7a'></a>3.21 mathutil.lisp</h3>
<p>　<a class='autolink' href='#0uaBbu9jd7a'>mathutil.lisp</a> は以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
<li><a class='autolink' href='#g7U0GGx7sCV'>point.lisp</a></li>
</ul>
<h4><a name='67nITShIFxJ'></a>3.21.1 math/len2 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>math/len2</span> (pt1 pt2) ... )
</pre>
<p>　点 <code>pt1</code> から点 <code>pt2</code> までの距離を計算して返します。 <code>pt1</code> および <code>pt2</code> は point です。point が手元にない場合は <a class='autolink' href='#g56JpESyFgh'>math/len4</a> 関数を使用してください。</p>
<p>　以下の例では、 <code>(30 30)</code> から <code>(90 70)</code> までの距離を計算しています。</p>
<pre class='code'>
(<span class='keyword1'>let</span> ((pt1 (make-point 30 30))
      (pt2 (make-point 90 70)))
  (math/len2 pt1 pt2))
<span class='comment'>;=&gt; 72.11102</span>
</pre>
<p>　これは、以下の青い線の部分の長さを測っていることになります。</p>
<div align='center'>
<?xml version='1.0' encoding='utf-8' ?>
<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' baseProfile='full' xml:space='default' width='150' height='100'>
	
	<!-- grid -->
	<pattern id='__grid' width='10' height='10' patternUnits='userSpaceOnUse' >
		<rect x='0' y='0' width='10' height='10' fill='white' />
		<polyline fill='none' stroke='gray' stroke-width='0.2' points='10,0 0,0 0,10' />
	</pattern>
	<rect x='0' y='0' width='100%' height='100%' fill='url(#__grid)' stroke='gray' stroke-width='0.2' />
	<!-- pt1 : circle -->
	<circle id='pt1' cx='30' cy='30' r='3' fill='red' stroke='none' stroke-width='1' />
	<!-- text -->
	<text x='35' y='25' text-anchor='start' font-size='12pt' fill='black' >(30 30)</text>
	<!-- pt2 : circle -->
	<circle id='pt2' cx='90' cy='70' r='3' fill='red' stroke='none' stroke-width='1' />
	<!-- text -->
	<text x='95' y='75' text-anchor='start' font-size='12pt' fill='black' >(90 70)</text>
	<!-- connector from pt1 to pt2 -->
	<polyline fill='none' stroke='blue' stroke-width='1' points=' 32.49615,31.6641 87.503845,68.3359' />

</svg>
</div>

<h4><a name='g56JpESyFgh'></a>3.21.2 math/len4 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>math/len4</span> (x1 y1 x2 y2) ... )
</pre>
<p>　点 <code>(x1 y1)</code> から点 <code>(x2 y2)</code> までの距離を計算して返します。point が手元にある場合は <a class='autolink' href='#67nITShIFxJ'>math/len2</a> 関数を使用してください。</p>
<p>　以下の例では、 <code>(30 30)</code> から <code>(90 70)</code> までの距離を計算しています。</p>
<pre class='code'>
(math/len4 30 30 90 70)
<span class='comment'>;=&gt; 72.11102</span>
</pre>
<p>　これは、以下の青い線の部分の長さを測っていることになります。</p>
<div align='center'>
<?xml version='1.0' encoding='utf-8' ?>
<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' baseProfile='full' xml:space='default' width='150' height='100'>
	
	<!-- grid -->
	<pattern id='__grid' width='10' height='10' patternUnits='userSpaceOnUse' >
		<rect x='0' y='0' width='10' height='10' fill='white' />
		<polyline fill='none' stroke='gray' stroke-width='0.2' points='10,0 0,0 0,10' />
	</pattern>
	<rect x='0' y='0' width='100%' height='100%' fill='url(#__grid)' stroke='gray' stroke-width='0.2' />
	<!-- pt1 : circle -->
	<circle id='pt1' cx='30' cy='30' r='3' fill='red' stroke='none' stroke-width='1' />
	<!-- text -->
	<text x='35' y='25' text-anchor='start' font-size='12pt' fill='black' >(30 30)</text>
	<!-- pt2 : circle -->
	<circle id='pt2' cx='90' cy='70' r='3' fill='red' stroke='none' stroke-width='1' />
	<!-- text -->
	<text x='95' y='75' text-anchor='start' font-size='12pt' fill='black' >(90 70)</text>
	<!-- connector from pt1 to pt2 -->
	<polyline fill='none' stroke='blue' stroke-width='1' points=' 32.49615,31.6641 87.503845,68.3359' />

</svg>
</div>

<h4><a name='fCFNMHaH1sc'></a>3.21.3 math/sin1 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>math/sin1</span> (degree) ... )
</pre>
<p>　角度 <code>degree</code> の sin を計算して返します。 <code>degree</code> は [0, 360) である必要があります。</p>
<h4><a name='19JyiABSLdD'></a>3.21.4 math/cos1 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>math/cos1</span> (degree) ... )
</pre>
<p>　角度 <code>degree</code> の cos を計算して返します。 <code>degree</code> は [0, 360) である必要があります。</p>
<h4><a name='hvzNb6abVJr'></a>3.21.5 math/sin2 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>math/sin2</span> (pt1 pt2) ... )
</pre>
<p>　2 点 <code>pt1, pt2</code> を通る直線が x 軸に対してなす角度の sin を計算して返します。 <code>pt1</code> および <code>pt2</code> は point です。すなわち、以下における <code>b / len</code> を計算します。point が手元にない場合は <a class='autolink' href='#4NyvBxygvjx'>math/sin4</a> 関数を使用してください。</p>
<div align='center'>
<?xml version='1.0' encoding='utf-8' ?>
<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' baseProfile='full' xml:space='default' width='200' height='100'>
	
	<!-- grid -->
	<pattern id='__grid' width='10' height='10' patternUnits='userSpaceOnUse' >
		<rect x='0' y='0' width='10' height='10' fill='white' />
		<polyline fill='none' stroke='gray' stroke-width='0.2' points='10,0 0,0 0,10' />
	</pattern>
	<rect x='0' y='0' width='100%' height='100%' fill='url(#__grid)' stroke='gray' stroke-width='0.2' />
	<!-- line -->
	<polyline fill='none' stroke='gray' stroke-width='1' stroke-dasharray='2 2 ' points=' 50.0,30.0 150.0,30.0' />
	<!-- line -->
	<polyline fill='none' stroke='gray' stroke-width='1' stroke-dasharray='2 2 ' points=' 150.0,70.0 150.0,30.0' />
	<!-- line -->
	<polyline fill='none' stroke='blue' stroke-width='1' points=' 50.0,30.0 150.0,70.0' />
	<!-- circle -->
	<circle cx='50' cy='30' r='3' fill='red' stroke='none' stroke-width='1' />
	<!-- text -->
	<text x='50' y='20' text-anchor='end' font-size='12pt' fill='black' >pt1</text>
	<!-- circle -->
	<circle cx='150' cy='70' r='3' fill='red' stroke='none' stroke-width='1' />
	<!-- text -->
	<text x='150' y='85' text-anchor='start' font-size='12pt' fill='black' >pt2</text>
	<!-- text -->
	<text x='100' y='27' text-anchor='start' font-size='12pt' fill='black' >a</text>
	<!-- text -->
	<text x='155' y='55' text-anchor='start' font-size='12pt' fill='black' >b</text>
	<!-- text -->
	<text x='90' y='70' text-anchor='start' font-size='12pt' fill='black' >len</text>

</svg>
</div>

<h4><a name='9Uw5mXSJ6LO'></a>3.21.6 math/cos2 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>math/cos2</span> (pt1 pt2) ... )
</pre>
<p>　2 点 <code>pt1, pt2</code> を通る直線が x 軸に対してなす角度の cos を計算して返します。 <code>pt1</code> および <code>pt2</code> は point です。すなわち、以下における <code>a / len</code> を計算します。point が手元にない場合は <a class='autolink' href='#cjix05YHSz4'>math/cos4</a> 関数を使用してください。</p>
<div align='center'>
<?xml version='1.0' encoding='utf-8' ?>
<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' baseProfile='full' xml:space='default' width='200' height='100'>
	
	<!-- grid -->
	<pattern id='__grid' width='10' height='10' patternUnits='userSpaceOnUse' >
		<rect x='0' y='0' width='10' height='10' fill='white' />
		<polyline fill='none' stroke='gray' stroke-width='0.2' points='10,0 0,0 0,10' />
	</pattern>
	<rect x='0' y='0' width='100%' height='100%' fill='url(#__grid)' stroke='gray' stroke-width='0.2' />
	<!-- line -->
	<polyline fill='none' stroke='gray' stroke-width='1' stroke-dasharray='2 2 ' points=' 50.0,30.0 150.0,30.0' />
	<!-- line -->
	<polyline fill='none' stroke='gray' stroke-width='1' stroke-dasharray='2 2 ' points=' 150.0,70.0 150.0,30.0' />
	<!-- line -->
	<polyline fill='none' stroke='blue' stroke-width='1' points=' 50.0,30.0 150.0,70.0' />
	<!-- circle -->
	<circle cx='50' cy='30' r='3' fill='red' stroke='none' stroke-width='1' />
	<!-- text -->
	<text x='50' y='20' text-anchor='end' font-size='12pt' fill='black' >pt1</text>
	<!-- circle -->
	<circle cx='150' cy='70' r='3' fill='red' stroke='none' stroke-width='1' />
	<!-- text -->
	<text x='150' y='85' text-anchor='start' font-size='12pt' fill='black' >pt2</text>
	<!-- text -->
	<text x='100' y='27' text-anchor='start' font-size='12pt' fill='black' >a</text>
	<!-- text -->
	<text x='155' y='55' text-anchor='start' font-size='12pt' fill='black' >b</text>
	<!-- text -->
	<text x='90' y='70' text-anchor='start' font-size='12pt' fill='black' >len</text>

</svg>
</div>

<h4><a name='6pdmmd85Tsd'></a>3.21.7 math/sin3 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>math/sin3</span> (pt1 pt2 degree) ... )
</pre>
<p>　2 点 <code>pt1, pt2</code> を通る直線に対して角度 <code>degree</code> をなす直線が x 軸に対してなす角度の sin を計算して返します。 <code>pt1</code> および <code>pt2</code> は point です。すなわち、以下における <code>sin θ</code> を返します。 <code>degree</code> は [0, 360) である必要があります。point が手元にない場合は <a class='autolink' href='#fFCXUJE5Dqj'>math/sin5</a> 関数を使用してください。</p>
<div align='center'>
<?xml version='1.0' encoding='utf-8' ?>
<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' baseProfile='full' xml:space='default' width='200' height='100'>
	
	<!-- grid -->
	<pattern id='__grid' width='10' height='10' patternUnits='userSpaceOnUse' >
		<rect x='0' y='0' width='10' height='10' fill='white' />
		<polyline fill='none' stroke='gray' stroke-width='0.2' points='10,0 0,0 0,10' />
	</pattern>
	<rect x='0' y='0' width='100%' height='100%' fill='url(#__grid)' stroke='gray' stroke-width='0.2' />
	<!-- line -->
	<polyline fill='none' stroke='gray' stroke-width='1' stroke-dasharray='2 2 ' points=' 40.0,0.0 80.0,120.0' />
	<!-- line -->
	<polyline fill='none' stroke='blue' stroke-width='1' points=' 50.0,30.0 150.0,70.0' />
	<!-- circle -->
	<circle cx='50' cy='30' r='3' fill='red' stroke='none' stroke-width='1' />
	<!-- circle -->
	<circle cx='150' cy='70' r='3' fill='red' stroke='none' stroke-width='1' />
	<!-- arc -->
	<path fill='none' stroke='black' stroke-width='1' d='M 68.79385241571816 36.84040286651337 A 20 20 0 0 1 56.180339887498945 49.02113032590307' />
	<!-- arc -->
	<path fill='none' stroke='black' stroke-width='1' d='M 60.0 0.0 A 20 20 0 0 1 46.180339887498945 19.02113032590307' />
	<!-- text -->
	<text x='45' y='40' text-anchor='end' font-size='12pt' fill='black' >pt1</text>
	<!-- text -->
	<text x='150' y='85' text-anchor='start' font-size='12pt' fill='black' >pt2</text>
	<!-- text -->
	<text x='70' y='70' text-anchor='start' font-size='12pt' fill='black' >degree</text>
	<!-- text -->
	<text x='60' y='20' text-anchor='start' font-size='12pt' fill='black' >θ</text>

</svg>
</div>

<h4><a name='kMKsf1DD0li'></a>3.21.8 math/cos3 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>math/cos3</span> (pt1 pt2 degree) ... )
</pre>
<p>　2 点 <code>pt1, pt2</code> を通る直線に対して角度 <code>degree</code> をなす直線が x 軸に対してなす角度の cos を計算して返します。 <code>pt1</code> および <code>pt2</code> は point です。すなわち、以下における <code>cos θ</code> を返します。 <code>degree</code> は [0, 360) である必要があります。point が手元にない場合は <a class='autolink' href='#1cLxT7jnweu'>math/cos5</a> 関数を使用してください。</p>
<div align='center'>
<?xml version='1.0' encoding='utf-8' ?>
<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' baseProfile='full' xml:space='default' width='200' height='100'>
	
	<!-- grid -->
	<pattern id='__grid' width='10' height='10' patternUnits='userSpaceOnUse' >
		<rect x='0' y='0' width='10' height='10' fill='white' />
		<polyline fill='none' stroke='gray' stroke-width='0.2' points='10,0 0,0 0,10' />
	</pattern>
	<rect x='0' y='0' width='100%' height='100%' fill='url(#__grid)' stroke='gray' stroke-width='0.2' />
	<!-- line -->
	<polyline fill='none' stroke='gray' stroke-width='1' stroke-dasharray='2 2 ' points=' 40.0,0.0 80.0,120.0' />
	<!-- line -->
	<polyline fill='none' stroke='blue' stroke-width='1' points=' 50.0,30.0 150.0,70.0' />
	<!-- circle -->
	<circle cx='50' cy='30' r='3' fill='red' stroke='none' stroke-width='1' />
	<!-- circle -->
	<circle cx='150' cy='70' r='3' fill='red' stroke='none' stroke-width='1' />
	<!-- arc -->
	<path fill='none' stroke='black' stroke-width='1' d='M 68.79385241571816 36.84040286651337 A 20 20 0 0 1 56.180339887498945 49.02113032590307' />
	<!-- arc -->
	<path fill='none' stroke='black' stroke-width='1' d='M 60.0 0.0 A 20 20 0 0 1 46.180339887498945 19.02113032590307' />
	<!-- text -->
	<text x='45' y='40' text-anchor='end' font-size='12pt' fill='black' >pt1</text>
	<!-- text -->
	<text x='150' y='85' text-anchor='start' font-size='12pt' fill='black' >pt2</text>
	<!-- text -->
	<text x='70' y='70' text-anchor='start' font-size='12pt' fill='black' >degree</text>
	<!-- text -->
	<text x='60' y='20' text-anchor='start' font-size='12pt' fill='black' >θ</text>

</svg>
</div>

<h4><a name='4NyvBxygvjx'></a>3.21.9 math/sin4 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>math/sin4</span> (x1 y1 x2 y2) ... )
</pre>
<p>　2 点 <code>(x1 y1), (x2 y2)</code> を通る直線が x 軸に対してなす角度の sin を計算して返します。すなわち、以下における <code>b / len</code> を計算します。point が手元にある場合は <a class='autolink' href='#hvzNb6abVJr'>math/sin2</a> 関数を使用してください。</p>
<div align='center'>
<?xml version='1.0' encoding='utf-8' ?>
<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' baseProfile='full' xml:space='default' width='200' height='100'>
	
	<!-- grid -->
	<pattern id='__grid' width='10' height='10' patternUnits='userSpaceOnUse' >
		<rect x='0' y='0' width='10' height='10' fill='white' />
		<polyline fill='none' stroke='gray' stroke-width='0.2' points='10,0 0,0 0,10' />
	</pattern>
	<rect x='0' y='0' width='100%' height='100%' fill='url(#__grid)' stroke='gray' stroke-width='0.2' />
	<!-- line -->
	<polyline fill='none' stroke='gray' stroke-width='1' stroke-dasharray='2 2 ' points=' 50.0,30.0 150.0,30.0' />
	<!-- line -->
	<polyline fill='none' stroke='gray' stroke-width='1' stroke-dasharray='2 2 ' points=' 150.0,70.0 150.0,30.0' />
	<!-- line -->
	<polyline fill='none' stroke='blue' stroke-width='1' points=' 50.0,30.0 150.0,70.0' />
	<!-- circle -->
	<circle cx='50' cy='30' r='3' fill='red' stroke='none' stroke-width='1' />
	<!-- text -->
	<text x='50' y='20' text-anchor='end' font-size='12pt' fill='black' >(x1 y1)</text>
	<!-- circle -->
	<circle cx='150' cy='70' r='3' fill='red' stroke='none' stroke-width='1' />
	<!-- text -->
	<text x='150' y='85' text-anchor='start' font-size='12pt' fill='black' >(x2 y2)</text>
	<!-- text -->
	<text x='100' y='27' text-anchor='start' font-size='12pt' fill='black' >a</text>
	<!-- text -->
	<text x='155' y='55' text-anchor='start' font-size='12pt' fill='black' >b</text>
	<!-- text -->
	<text x='90' y='70' text-anchor='start' font-size='12pt' fill='black' >len</text>

</svg>
</div>

<h4><a name='cjix05YHSz4'></a>3.21.10 math/cos4 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>math/cos4</span> (x1 y1 x2 y2) ... )
</pre>
<p>　2 点 <code>(x1 y1), (x2 y2)</code> を通る直線が x 軸に対してなす角度の cos を計算して返します。すなわち、以下における <code>a / len</code> を計算します。point が手元にある場合は <a class='autolink' href='#9Uw5mXSJ6LO'>math/cos2</a> 関数を使用してください。</p>
<div align='center'>
<?xml version='1.0' encoding='utf-8' ?>
<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' baseProfile='full' xml:space='default' width='200' height='100'>
	
	<!-- grid -->
	<pattern id='__grid' width='10' height='10' patternUnits='userSpaceOnUse' >
		<rect x='0' y='0' width='10' height='10' fill='white' />
		<polyline fill='none' stroke='gray' stroke-width='0.2' points='10,0 0,0 0,10' />
	</pattern>
	<rect x='0' y='0' width='100%' height='100%' fill='url(#__grid)' stroke='gray' stroke-width='0.2' />
	<!-- line -->
	<polyline fill='none' stroke='gray' stroke-width='1' stroke-dasharray='2 2 ' points=' 50.0,30.0 150.0,30.0' />
	<!-- line -->
	<polyline fill='none' stroke='gray' stroke-width='1' stroke-dasharray='2 2 ' points=' 150.0,70.0 150.0,30.0' />
	<!-- line -->
	<polyline fill='none' stroke='blue' stroke-width='1' points=' 50.0,30.0 150.0,70.0' />
	<!-- circle -->
	<circle cx='50' cy='30' r='3' fill='red' stroke='none' stroke-width='1' />
	<!-- text -->
	<text x='50' y='20' text-anchor='end' font-size='12pt' fill='black' >(x1 y1)</text>
	<!-- circle -->
	<circle cx='150' cy='70' r='3' fill='red' stroke='none' stroke-width='1' />
	<!-- text -->
	<text x='150' y='85' text-anchor='start' font-size='12pt' fill='black' >(x2 y2)</text>
	<!-- text -->
	<text x='100' y='27' text-anchor='start' font-size='12pt' fill='black' >a</text>
	<!-- text -->
	<text x='155' y='55' text-anchor='start' font-size='12pt' fill='black' >b</text>
	<!-- text -->
	<text x='90' y='70' text-anchor='start' font-size='12pt' fill='black' >len</text>

</svg>
</div>

<h4><a name='fFCXUJE5Dqj'></a>3.21.11 math/sin5 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>math/sin5</span> (x1 y1 x2 y2 degree) ... )
</pre>
<p>　2 点 <code>(x1 y1), (x2 y2)</code> を通る直線に対して角度 <code>degree</code> をなす直線が x 軸に対してなす角度の sin を計算して返します。すなわち、以下における <code>sin θ</code> を返します。 <code>degree</code> は [0, 360) である必要があります。point が手元にある場合は <a class='autolink' href='#6pdmmd85Tsd'>math/sin3</a> 関数を使用してください。</p>
<div align='center'>
<?xml version='1.0' encoding='utf-8' ?>
<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' baseProfile='full' xml:space='default' width='200' height='100'>
	
	<!-- grid -->
	<pattern id='__grid' width='10' height='10' patternUnits='userSpaceOnUse' >
		<rect x='0' y='0' width='10' height='10' fill='white' />
		<polyline fill='none' stroke='gray' stroke-width='0.2' points='10,0 0,0 0,10' />
	</pattern>
	<rect x='0' y='0' width='100%' height='100%' fill='url(#__grid)' stroke='gray' stroke-width='0.2' />
	<!-- line -->
	<polyline fill='none' stroke='gray' stroke-width='1' stroke-dasharray='2 2 ' points=' 40.0,0.0 80.0,120.0' />
	<!-- line -->
	<polyline fill='none' stroke='blue' stroke-width='1' points=' 50.0,30.0 150.0,70.0' />
	<!-- circle -->
	<circle cx='50' cy='30' r='3' fill='red' stroke='none' stroke-width='1' />
	<!-- circle -->
	<circle cx='150' cy='70' r='3' fill='red' stroke='none' stroke-width='1' />
	<!-- arc -->
	<path fill='none' stroke='black' stroke-width='1' d='M 68.79385241571816 36.84040286651337 A 20 20 0 0 1 56.180339887498945 49.02113032590307' />
	<!-- arc -->
	<path fill='none' stroke='black' stroke-width='1' d='M 60.0 0.0 A 20 20 0 0 1 46.180339887498945 19.02113032590307' />
	<!-- text -->
	<text x='48' y='40' text-anchor='end' font-size='12pt' fill='black' >(x1 y1)</text>
	<!-- text -->
	<text x='150' y='85' text-anchor='start' font-size='12pt' fill='black' >(x2 y2)</text>
	<!-- text -->
	<text x='70' y='70' text-anchor='start' font-size='12pt' fill='black' >degree</text>
	<!-- text -->
	<text x='60' y='20' text-anchor='start' font-size='12pt' fill='black' >θ</text>

</svg>
</div>

<h4><a name='1cLxT7jnweu'></a>3.21.12 math/cos5 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>math/cos5</span> (x1 y1 x2 y2 degree) ... )
</pre>
<p>　2 点 <code>(x1 y1), (x2 y2)</code> を通る直線に対して角度 <code>degree</code> をなす直線が x 軸に対してなす角度の cos を計算して返します。すなわち、以下における <code>cos θ</code> を返します。 <code>degree</code> は [0, 360) である必要があります。point が手元にある場合は <a class='autolink' href='#kMKsf1DD0li'>math/cos3</a> 関数を使用してください。</p>
<div align='center'>
<?xml version='1.0' encoding='utf-8' ?>
<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1' baseProfile='full' xml:space='default' width='200' height='100'>
	
	<!-- grid -->
	<pattern id='__grid' width='10' height='10' patternUnits='userSpaceOnUse' >
		<rect x='0' y='0' width='10' height='10' fill='white' />
		<polyline fill='none' stroke='gray' stroke-width='0.2' points='10,0 0,0 0,10' />
	</pattern>
	<rect x='0' y='0' width='100%' height='100%' fill='url(#__grid)' stroke='gray' stroke-width='0.2' />
	<!-- line -->
	<polyline fill='none' stroke='gray' stroke-width='1' stroke-dasharray='2 2 ' points=' 40.0,0.0 80.0,120.0' />
	<!-- line -->
	<polyline fill='none' stroke='blue' stroke-width='1' points=' 50.0,30.0 150.0,70.0' />
	<!-- circle -->
	<circle cx='50' cy='30' r='3' fill='red' stroke='none' stroke-width='1' />
	<!-- circle -->
	<circle cx='150' cy='70' r='3' fill='red' stroke='none' stroke-width='1' />
	<!-- arc -->
	<path fill='none' stroke='black' stroke-width='1' d='M 68.79385241571816 36.84040286651337 A 20 20 0 0 1 56.180339887498945 49.02113032590307' />
	<!-- arc -->
	<path fill='none' stroke='black' stroke-width='1' d='M 60.0 0.0 A 20 20 0 0 1 46.180339887498945 19.02113032590307' />
	<!-- text -->
	<text x='48' y='40' text-anchor='end' font-size='12pt' fill='black' >(x1 y1)</text>
	<!-- text -->
	<text x='150' y='85' text-anchor='start' font-size='12pt' fill='black' >(x2 y2)</text>
	<!-- text -->
	<text x='70' y='70' text-anchor='start' font-size='12pt' fill='black' >degree</text>
	<!-- text -->
	<text x='60' y='20' text-anchor='start' font-size='12pt' fill='black' >θ</text>

</svg>
</div>

<h3><a name='bFs5bJqLCfb'></a>3.22 paragraph.lisp</h3>
<p>　<a class='autolink' href='#bFs5bJqLCfb'>paragraph.lisp</a> は以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
<li><a class='autolink' href='#3c2PhHDsO5I'>constants.lisp</a></li>
<li><a class='autolink' href='#jzen8zyw08N'>shape.lisp</a></li>
<li><a class='autolink' href='#l9bqLva3rj6'>font-info.lisp</a></li>
<li><a class='autolink' href='#k0U5yutENit'>link-info.lisp</a></li>
<li><a class='autolink' href='#g7U0GGx7sCV'>point.lisp</a></li>
<li><a class='autolink' href='#7NkNOcI9zDh'>writer.lisp</a></li>
</ul>
<h3><a name='9k30aVu2Utl'></a>3.23 path.lisp</h3>
<p>　<a class='autolink' href='#9k30aVu2Utl'>path.lisp</a> は以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
<li><a class='autolink' href='#3c2PhHDsO5I'>constants.lisp</a></li>
<li><a class='autolink' href='#au8IebMfeov'>fill-info.lisp</a></li>
<li><a class='autolink' href='#5S5mEI6PrDL'>stroke-info.lisp</a></li>
<li><a class='autolink' href='#h05k6V1sTsF'>entity.lisp</a></li>
<li><a class='autolink' href='#7NkNOcI9zDh'>writer.lisp</a></li>
</ul>
<h3><a name='kEmV3k1rXYD'></a>3.24 pathutil.lisp</h3>
<p>　<a class='autolink' href='#kEmV3k1rXYD'>pathutil.lisp</a> は以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
</ul>
<p>　pathutil はファイル名やパス名を扱うための関数群を提供します。「Practical Common LISP」で紹介されている pathname utility から必要なものだけを抽出したものです。</p>
<h4><a name='jwjWt2iFfEC'></a>3.24.1 path/is-directory-name 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>path/is-directory-name</span> (p) ... )
</pre>
<p>　<code>p</code> がディレクトリ名か否かを返します。</p>
<h4><a name='dnb6iFWVo0r'></a>3.24.2 path/is-file-name 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>path/is-file-name</span> (p) ... )
</pre>
<p>　<code>p</code> がファイル名か否かを返します。</p>
<h4><a name='0gP9e1yak7W'></a>3.24.3 path/is-exists 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>path/is-exists</span> (pathname) ... )
</pre>
<p>　<code>name</code> が実際に存在するか否かを返します。ファイルかディレクトリかを問いません。</p>
<h4><a name='9bWAiPeVsu8'></a>3.24.4 path/is-existing-file 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>path/is-existing-file</span> (name) ... )
</pre>
<p>　<code>name</code> が実際に存在するファイルであるか否かを返します。</p>
<h4><a name='6UyJ4WDXJRL'></a>3.24.5 path/get-time 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>path/get-time</span> (pathname <span class='keyword2'>&amp;optional</span> (type <span class='keyword3'>:string</span>)) ... )
</pre>
<p>　<code>pathname</code> で指定した名前のファイルについて、その更新日付を返します。オプションの <code>type</code> 引数の値によって、返される値の形式が変わります。</p>
<table align='center'>
<tr><th>type</th><th>返される値の形式</th></tr>
<tr><td align='center'>:string</td><td align='left'>"yyyy/mm/dd HH:MM:SS" 形式の文字列</td></tr>
<tr><td align='center'>:value</td><td align='left'>日付を表す数値</td></tr>
<tr><td align='center'>:values</td><td align='left'>多値</td></tr>
<tr><td align='center'>キーワードシンボルのリスト</td><td align='left'>キーワードに対応する値をまとめたリスト</td></tr>
</table>
<p>　最後のリストで要素に使用できるキーワードシンボルは以下の通りです。</p>
<ul>
<li><code>:second</code></li>
<li><code>:minute</code></li>
<li><code>:hour</code></li>
<li><code>:date</code></li>
<li><code>:month</code></li>
<li><code>:year</code></li>
<li><code>:day</code></li>
<li><code>:daylight-p</code></li>
<li><code>:zone</code></li>
</ul>
<p>　以下に例を示します。</p>
<pre class='code'>
(diagram::path/get-time file-name)
<span class='comment'>; =&gt; "2021/07/19 22:07:54"</span>
(diagram::path/get-time file-name :string)
<span class='comment'>; =&gt; "2021/07/19 22:07:54"</span>
(diagram::path/get-time file-name :value)
<span class='comment'>; =&gt; 3835688874</span>
(diagram::path/get-time file-name :values)
<span class='comment'>; =&gt; 54</span>
<span class='comment'>;    7</span>
<span class='comment'>;    22</span>
<span class='comment'>;    19</span>
<span class='comment'>;    7</span>
<span class='comment'>;    2021</span>
<span class='comment'>;    0</span>
<span class='comment'>;    NIL</span>
<span class='comment'>;    -9</span>
(diagram::path/get-time file-name '(:year :month :date))
<span class='comment'>; =&gt; (2021 7 19)</span>
</pre>
<h4><a name='hMXfb1i1Vwi'></a>3.24.6 path/get-current-directory 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>path/get-current-directory</span> () ... )
</pre>
<p>　カレントディレクトリを pathname オブジェクトで返します。</p>
<h4><a name='59X9Til78JV'></a>3.24.7 path/set-current-directory 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>path/set-current-directory</span> (new-pathname) ... )
</pre>
<p>　カレントディレクトリを変更します。</p>
<h3><a name='g7U0GGx7sCV'></a>3.25 point.lisp</h3>
<p>　<a class='autolink' href='#g7U0GGx7sCV'>point.lisp</a> は以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
</ul>
<p>　<a class='autolink' href='#2xCCaUuNLlH'>diagram</a> の座標は point を使って表現します。これは基本的に 2 要素の数値のリストで、通常は <a class='autolink' href='#cV08aR4hVCU'>make-point</a> 関数で作成します。</p>
<pre class='code'>
 (make-point 1 2) <span class='comment'>; =&gt; (1 2)</span>
</pre>
<p>　実際には、座標には <strong>絶対座標</strong> と <strong>相対座標</strong> があり、それを指定するための <code>&amp;optional</code> パラメータが存在します。</p>
<pre class='code'>
 (make-point 1 2 <span class='keyword3'>:absolute</span>) <span class='comment'>; =&gt; (1 2 . :absolute)</span>
</pre>
<h4><a name='cV08aR4hVCU'></a>3.25.1 make-point 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>make-point</span> (x y <span class='keyword2'>&amp;optional</span> type) ... )
</pre>
<p>　point を作成するには、x, y を指定して <a class='autolink' href='#cV08aR4hVCU'>make-point</a> 関数をコールします。オプションで <code>:abosolute</code> か <code>:relative</code> を指定できます。省略した場合は <code>:relative</code> になります。これらは絶対座標か相対座標の区別です。</p>
<h4><a name='i9EtqjnJKkh'></a>3.25.2 copy-point 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>copy-point</span> (pt) ... )
</pre>
<p>　point を複製するには <a class='autolink' href='#i9EtqjnJKkh'>copy-point</a> 関数を使ってください。</p>
<h4><a name='eYsB94h8ozm'></a>3.25.3 point-p 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>point-p</span> (pt) ... )
</pre>
<h4><a name='k76Q8kszUmj'></a>3.25.4 point-absolute-p 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>point-absolute-p</span> (pt) ... )
</pre>
<p>　point が絶対座標か否かは <a class='autolink' href='#k76Q8kszUmj'>point-absolute-p</a> 関数を使って判定します。</p>
<h4><a name='8ARSCNEXCwM'></a>3.25.5 point-relative-p 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>point-relative-p</span> (pt) ... )
</pre>
<p>　point が相対座標か否かは <a class='autolink' href='#8ARSCNEXCwM'>point-relative-p</a> 関数を使って判定します。</p>
<h4><a name='et6gePtgg50'></a>3.25.6 point-x 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>point-x</span> (pt) ... )
(<span class='keyword1'>defun</span> (setf point-x) (val pt) ... )
</pre>
<p>　point が保持する x 座標の値を取得／設定するには <a class='autolink' href='#et6gePtgg50'>point-x</a> 関数を使用します。</p>
<h4><a name='3B2wOhg6fxU'></a>3.25.7 point-y 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>point-y</span> (pt) ... )
(<span class='keyword1'>defun</span> (setf point-y) (val pt) ... )
</pre>
<p>　point が保持する y 座標の値を取得／設定するには <a class='autolink' href='#3B2wOhg6fxU'>point-y</a> 関数を使用します。</p>
<h4><a name='fCZ08hHsf3N'></a>3.25.8 point+ 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>point+</span> (pt1 pt2) ... )
</pre>
<h4><a name='6mwEJ7qyOKN'></a>3.25.9 point- 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>point-</span> (pt1 pt2) ... )
</pre>
<h4><a name='lEZ6oy96fUH'></a>3.25.10 point/x+ 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>point/x+</span> (pt x) ... )
</pre>
<p>　point の x に加減算をした新しい point を作成して返します。頻繁に使用するため、同じことをする <a class='autolink' href='#lEZ6oy96fUH'>x+</a> という関数も用意しています。</p>
<h4><a name='awgH1J8YsIC'></a>3.25.11 point/y+ 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>point/y+</span> (pt y) ... )
</pre>
<p>　point の y に加減算をした新しい point を作成して返します。頻繁に使用するため、同じことをする <a class='autolink' href='#awgH1J8YsIC'>y+</a> という関数も用意しています。</p>
<h4><a name='3nSG8ftc6m8'></a>3.25.12 point/xy+ 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>point/xy+</span> (pt x y) ... )
</pre>
<p>　point の x, y に加減算をした新しい point を作成して返します。頻繁に使用するため、同じことをする <a class='autolink' href='#3nSG8ftc6m8'>xy+</a> という関数も用意しています。</p>
<h4><a name='1cQLTt5yCRi'></a>3.25.13 point-distance 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>point-distance</span> (pt1 pt2) ... )
</pre>
<p>　2 つの point 間の距離は <a class='autolink' href='#1cQLTt5yCRi'>point-distance</a> 関数で測ることができます。</p>
<h4><a name='ekClPzGH4mL'></a>3.25.14 with-point マクロ</h4>
<pre class='code'>
(<span class='keyword1'>defmacro</span> <span class='keyword5'>with-point</span> ((sym-x sym-y) pt <span class='keyword2'>&amp;rest</span> body) ... )
</pre>
<p>　point の x, y に symbol-macrolet でアクセスしたければ <a class='autolink' href='#ekClPzGH4mL'>with-point</a> マクロが使えます。</p>
<p>　　</p>
<h3><a name='ggdkX0SpYat'></a>3.26 polygon.lisp</h3>
<p>　<a class='autolink' href='#ggdkX0SpYat'>polygon.lisp</a> は以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
<li><a class='autolink' href='#3c2PhHDsO5I'>constants.lisp</a></li>
<li><a class='autolink' href='#au8IebMfeov'>fill-info.lisp</a></li>
<li><a class='autolink' href='#5S5mEI6PrDL'>stroke-info.lisp</a></li>
<li><a class='autolink' href='#k0U5yutENit'>link-info.lisp</a></li>
<li><a class='autolink' href='#h05k6V1sTsF'>entity.lisp</a></li>
<li><a class='autolink' href='#7NkNOcI9zDh'>writer.lisp</a></li>
</ul>
<h3><a name='g7IEYVlAFRK'></a>3.27 raw-svg.lisp</h3>
<p>　<a class='autolink' href='#g7IEYVlAFRK'>raw-svg.lisp</a> は以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
<li><a class='autolink' href='#h05k6V1sTsF'>entity.lisp</a></li>
<li><a class='autolink' href='#7NkNOcI9zDh'>writer.lisp</a></li>
</ul>
<h3><a name='c1IDRaD20g3'></a>3.28 rectangle.lisp</h3>
<p>　<a class='autolink' href='#c1IDRaD20g3'>rectangle.lisp</a> は以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
<li><a class='autolink' href='#3c2PhHDsO5I'>constants.lisp</a></li>
<li><a class='autolink' href='#jkshMjTfNSO'>canvas.lisp</a></li>
<li><a class='autolink' href='#g7U0GGx7sCV'>point.lisp</a></li>
<li><a class='autolink' href='#jzen8zyw08N'>shape.lisp</a></li>
<li><a class='autolink' href='#5S5mEI6PrDL'>stroke-info.lisp</a></li>
<li><a class='autolink' href='#k0U5yutENit'>link-info.lisp</a></li>
<li><a class='autolink' href='#7NkNOcI9zDh'>writer.lisp</a></li>
</ul>
<h3><a name='jzen8zyw08N'></a>3.29 shape.lisp</h3>
<p>　<a class='autolink' href='#jzen8zyw08N'>shape.lisp</a> は以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
<li><a class='autolink' href='#g7U0GGx7sCV'>point.lisp</a></li>
<li><a class='autolink' href='#jkshMjTfNSO'>canvas.lisp</a></li>
<li><a class='autolink' href='#0uaBbu9jd7a'>mathutil.lisp</a></li>
<li><a class='autolink' href='#h05k6V1sTsF'>entity.lisp</a></li>
<li><a class='autolink' href='#k0U5yutENit'>link-info.lisp</a></li>
</ul>
<h4><a name='f9LBhHlQ8Wm'></a>3.29.1 shape クラス</h4>
<p>　<a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> は class と link を保持します。どちらも nil が許可されます。</p>
<pre class='code'>
(<span class='keyword1'>defclass</span> <span class='keyword2'>shape</span> (entity)
  ((class <span class='keyword3'>:initform</span> nil <span class='keyword3'>:initarg</span> <span class='keyword3'>:class</span>)  <span class='comment'>; keyword</span>
   (link  <span class='keyword3'>:initform</span> nil <span class='keyword3'>:initarg</span> <span class='keyword3'>:link</span>))) <span class='comment'>; (or nil link-info)</span>
</pre>
<p>　<a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> はおおまかに言って、<a class='autolink' href='#coMfaBWu7eG'>entity</a> のうち「矩形領域を持つもの」です。つまりコネクタなどの接続線のようなものは含みません。</p>
<div align='center'>
<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="90px" preserveAspectRatio="none" style="width:280px;height:90px;background:#FFFFFF;" version="1.1" viewBox="0 0 280 90" width="280px" zoomAndPan="magnify"><defs/><g><!--MD5=[467568f20bbf29da492dca29e9e0779e]
class entity--><g id="elem_entity"><rect codeLine="2" fill="#F1F1F1" height="76" id="entity" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="103" x="7" y="7"/><ellipse cx="37.3" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M40.6906,24.9844 Q40.2688,29.9688 36.9563,29.9688 Q35.0031,29.9688 33.9563,27.9688 Q33.0813,26.2969 33.0813,23.3594 Q33.0813,20.3438 34.05,18.5781 Q35.05,16.7031 36.9563,16.7031 Q39.9875,16.7031 40.6125,21.1406 L38.5344,21.1406 Q38.175,18.6719 36.9563,18.6719 Q35.2219,18.6719 35.2219,23.3594 Q35.2219,28 36.9719,28 Q38.4094,28 38.5656,24.9844 L40.6906,24.9844 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37" x="54.7" y="28.3184">entity</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="109" y1="39" y2="39"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="13" y="55.3184">keyword id</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="13" y="69.3184">keyword layer</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="109" y1="75" y2="75"/></g><!--MD5=[4f91157a5a9a4f567f981e6a00c140e3]
class shape--><g id="elem_shape"><rect codeLine="6" fill="#F1F1F1" height="76" id="shape" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="103" x="170" y="7"/><ellipse cx="198.95" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M202.3406,24.9844 Q201.9188,29.9688 198.6063,29.9688 Q196.6531,29.9688 195.6063,27.9688 Q194.7313,26.2969 194.7313,23.3594 Q194.7313,20.3438 195.7,18.5781 Q196.7,16.7031 198.6063,16.7031 Q201.6375,16.7031 202.2625,21.1406 L200.1844,21.1406 Q199.825,18.6719 198.6063,18.6719 Q196.8719,18.6719 196.8719,23.3594 Q196.8719,28 198.6219,28 Q200.0594,28 200.2156,24.9844 L202.3406,24.9844 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="216.05" y="28.3184">shape</text><line style="stroke:#181818;stroke-width:0.5;" x1="171" x2="272" y1="39" y2="39"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="176" y="55.3184">keyword class</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="176" y="69.3184">link-info link</text><line style="stroke:#181818;stroke-width:0.5;" x1="171" x2="272" y1="75" y2="75"/></g><!--MD5=[401a871b595d3ba5385d1c54de4066b6]
reverse link entity to shape--><g id="link_entity_shape"><path codeLine="10" d="M130.71,45 C143.91,45 157.46,45 169.89,45 " fill="none" id="entity-backto-shape" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="130.44,52,110.44,45,130.44,38,130.44,52" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[712f4fe05d496138bc7829ad656e2040]
@startuml
left to right direction
class entity {
  keyword id
  keyword layer
}
class shape {
  keyword class
  link-info link
}
entity <|- - shape
@enduml

PlantUML version 1.2022.5(Sat Apr 30 19:55:52 JST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: ja
Country: JP
--></g></svg></div>

<h4><a name='2UPPgaElgvy'></a>3.29.2 shape-width 総称関数</h4>
<pre class='code'>
(<span class='keyword1'>defgeneric</span> <span class='keyword5'>shape-width</span> (shp)) ... )
</pre>
<p>　<a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> かその派生クラスの「幅」を数値で返します。<a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> クラスでのデフォルト実装はありません。派生クラスで実装する必要があります。</p>
<h4><a name='lNU1gDLketF'></a>3.29.3 shape-height 総称関数</h4>
<pre class='code'>
(<span class='keyword1'>defgeneric</span> <span class='keyword5'>shape-height</span> (shp)) ... )
</pre>
<p>　<a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> かその派生クラスの「高さ」を数値で返します。<a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> クラスでのデフォルト実装はありません。派生クラスで実装する必要があります。</p>
<h4><a name='7aZE8rCgP1F'></a>3.29.4 shape-topleft 総称関数</h4>
<pre class='code'>
(<span class='keyword1'>defgeneric</span> <span class='keyword5'>shape-topleft</span> (shp)) ... )
</pre>
<p>　<a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> かその派生クラスの「左上の座標」を point で返します。<a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> クラスでのデフォルト実装では、以下から計算します。</p>
<ul>
<li><a class='autolink' href='#9FXddyX6ENz'>shape-center</a></li>
<li><a class='autolink' href='#2UPPgaElgvy'>shape-width</a></li>
<li><a class='autolink' href='#lNU1gDLketF'>shape-height</a></li>
</ul>
<h4><a name='kt6vKeEZlsN'></a>3.29.5 shape-top 総称関数</h4>
<pre class='code'>
(<span class='keyword1'>defgeneric</span> <span class='keyword5'>shape-top</span> (shp)) ... )
</pre>
<p>　<a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> かその派生クラスの「上端の座標」を point で返します。<a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> クラスでのデフォルト実装では、以下から計算します。</p>
<ul>
<li><a class='autolink' href='#9FXddyX6ENz'>shape-center</a></li>
<li><a class='autolink' href='#lNU1gDLketF'>shape-height</a></li>
</ul>
<h4><a name='85obV2niPlm'></a>3.29.6 shape-topright 総称関数</h4>
<pre class='code'>
(<span class='keyword1'>defgeneric</span> <span class='keyword5'>shape-topright</span> (shp)) ... )
</pre>
<p>　<a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> かその派生クラスの「右上の座標」を point で返します。<a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> クラスでのデフォルト実装では、以下から計算します。</p>
<ul>
<li><a class='autolink' href='#9FXddyX6ENz'>shape-center</a></li>
<li><a class='autolink' href='#2UPPgaElgvy'>shape-width</a></li>
<li><a class='autolink' href='#lNU1gDLketF'>shape-height</a></li>
</ul>
<h4><a name='jmh0xrnq31t'></a>3.29.7 shape-left 総称関数</h4>
<pre class='code'>
(<span class='keyword1'>defgeneric</span> <span class='keyword5'>shape-left</span> (shp)) ... )
</pre>
<p>　<a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> かその派生クラスの「左端の座標」を point で返します。<a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> クラスでのデフォルト実装では、以下から計算します。</p>
<ul>
<li><a class='autolink' href='#9FXddyX6ENz'>shape-center</a></li>
<li><a class='autolink' href='#2UPPgaElgvy'>shape-width</a></li>
</ul>
<h4><a name='9FXddyX6ENz'></a>3.29.8 shape-center 総称関数</h4>
<pre class='code'>
(<span class='keyword1'>defgeneric</span> <span class='keyword5'>shape-center</span> (shp)) ... )
</pre>
<p>　<a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> かその派生クラスの「中心」を point で返します。<a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> クラスでのデフォルト実装はありません。派生クラスで実装する必要があります。</p>
<h4><a name='h5SgyhRzdMg'></a>3.29.9 shape-right 総称関数</h4>
<pre class='code'>
(<span class='keyword1'>defgeneric</span> <span class='keyword5'>shape-right</span> (shp)) ... )
</pre>
<p>　<a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> かその派生クラスの「右端の座標」を point で返します。<a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> クラスでのデフォルト実装では、以下から計算します。</p>
<ul>
<li><a class='autolink' href='#9FXddyX6ENz'>shape-center</a></li>
<li><a class='autolink' href='#2UPPgaElgvy'>shape-width</a></li>
</ul>
<h4><a name='jDeI5NMpwGo'></a>3.29.10 shape-bottomleft 総称関数</h4>
<pre class='code'>
(<span class='keyword1'>defgeneric</span> <span class='keyword5'>shape-bottomleft</span> (shp)) ... )
</pre>
<p>　<a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> かその派生クラスの「左下の座標」を point で返します。<a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> クラスでのデフォルト実装では、以下から計算します。</p>
<ul>
<li><a class='autolink' href='#9FXddyX6ENz'>shape-center</a></li>
<li><a class='autolink' href='#2UPPgaElgvy'>shape-width</a></li>
<li><a class='autolink' href='#lNU1gDLketF'>shape-height</a></li>
</ul>
<h4><a name='5oyJIEI5Oql'></a>3.29.11 shape-bottom 総称関数</h4>
<pre class='code'>
(<span class='keyword1'>defgeneric</span> <span class='keyword5'>shape-bottom</span> (shp)) ... )
</pre>
<p>　<a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> かその派生クラスの「下端の座標」を point で返します。<a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> クラスでのデフォルト実装では、以下から計算します。</p>
<ul>
<li><a class='autolink' href='#9FXddyX6ENz'>shape-center</a></li>
<li><a class='autolink' href='#lNU1gDLketF'>shape-height</a></li>
</ul>
<h4><a name='3LYUCViihmz'></a>3.29.12 shape-bottomright 総称関数</h4>
<pre class='code'>
(<span class='keyword1'>defgeneric</span> <span class='keyword5'>shape-bottomright</span> (shp)) ... )
</pre>
<p>　<a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> かその派生クラスの「右下の座標」を point で返します。<a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> クラスでのデフォルト実装では、以下から計算します。</p>
<ul>
<li><a class='autolink' href='#9FXddyX6ENz'>shape-center</a></li>
<li><a class='autolink' href='#2UPPgaElgvy'>shape-width</a></li>
<li><a class='autolink' href='#lNU1gDLketF'>shape-height</a></li>
</ul>
<h4><a name='00NZ1og0jJj'></a>3.29.13 shape-get-subcanvas 総称関数</h4>
<pre class='code'>
(<span class='keyword1'>defgeneric</span> <span class='keyword5'>shape-get-subcanvas</span> (shp)) ... )
</pre>
<p>　<a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> のサブ<a class='autolink' href='#jXsxcbXYkll'>キャンバス</a>を canvas で返します。<a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> クラスでのデフォルト実装では、以下から計算します。つまり、単純に <a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> の矩形を返します。</p>
<ul>
<li><a class='autolink' href='#7aZE8rCgP1F'>shape-topleft</a></li>
<li><a class='autolink' href='#2UPPgaElgvy'>shape-width</a></li>
<li><a class='autolink' href='#lNU1gDLketF'>shape-height</a></li>
</ul>
<h4><a name='cGVh1Proq0b'></a>3.29.14 shape-cc-center 総称関数</h4>
<pre class='code'>
(<span class='keyword1'>defgeneric</span> <span class='keyword5'>shape-cc-center</span> (shp type)) ... )
</pre>
<p>　connector が <a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> <code>:CC</code> で接続するときの中心点を point で返します。type には <code>:from</code> または <code>:dest</code> が渡されます。<a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> クラスでのデフォルト実装では、<code>type</code> を無視して <code>(shape-center shp)</code> の呼び出し結果をそのまま返します。</p>
<p>　この総称関数は、特殊な <a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> のために用意されています。例としては uml-connector が挙げられます。これは、単一の <a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> で２ケ所に円を描画し、 <code>:from</code> で connector に接続する場合と <code>:dest</code> で connector に接続する場合で異なる円を使います。</p>
<h4><a name='itSpZJR99MH'></a>3.29.15 shape-connect-point 総称関数</h4>
<pre class='code'>
(<span class='keyword1'>defgeneric</span> <span class='keyword5'>shape-connect-point</span> (shp type1 type2 arg)) ... )
</pre>
<p>　<a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> に connector を接続する際の接続点を決定します。</p>
<table align='center'>
<tr><th>param</th><th>description</th></tr>
<tr><td align='center'>shp</td><td align='left'>接続点を決定したい <a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> オブジェクトが指定されます。</td></tr>
<tr><td align='center'>type1</td><td align='left'>connector のどちらの端点かが <code>:from, :dest</code> で指定されます。</td></tr>
<tr><td align='center'>type2</td><td align='left'>connector の shp への接続先が <code>:center, :top, :bottom, :left, :right</code> で指定されます。</td></tr>
<tr><td align='center'>arg</td><td align='left'>type2 が <code>:center</code> の場合、point オブジェクトで、connector の反対側の端点が指定されます。<br>         type2 が <code>:center</code> でない場合、-1,0,1 で補助的な接続位置が指定されます。</td></tr>
</table>
<p>　rectangle のような矩形の <a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> であれば、<a class='autolink' href='#f9LBhHlQ8Wm'>shape</a> 向けのデフォルト実装で問題なく機能するはずです。円や楕円などの形状や、もっと複雑な形状の場合、独自に実装をする必要があるかもしれません。</p>
<h3><a name='0ACA2jPppKO'></a>3.30 stencil.lisp</h3>
<p>　<a class='autolink' href='#0ACA2jPppKO'>stencil.lisp</a> は以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
<li><a class='autolink' href='#kEmV3k1rXYD'>pathutil.lisp</a></li>
</ul>
<h3><a name='5S5mEI6PrDL'></a>3.31 stroke-info.lisp</h3>
<p>　<a class='autolink' href='#5S5mEI6PrDL'>stroke-info.lisp</a> はストロークの指定を表現するクラスです。以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
</ul>
<h4><a name='7pITpDTSaVn'></a>3.31.1 *default-stroke*変数</h4>
<pre class='code'>
(<span class='keyword1'>defparameter</span> <span class='keyword4'>*default-stroke*</span> nil)
</pre>
<p>　デフォルトのストロークを表現するダイナミック変数です。初期状態では<code>(make-stroke :color :black :width 1 :opacity nil :linecap nil :linejoin nil :miterlimit nil :dasharray nil :dashoffset nil)</code> の結果が設定されます。</p>
<h4><a name='60ZvGU5q6jR'></a>3.31.2 stroke-info クラス</h4>
<p>　<a class='autolink' href='#60ZvGU5q6jR'>stroke-info</a> は 8 種類のメンバを保持します。いずれも nil が許可されます。</p>
<pre class='code'>
(<span class='keyword1'>defclass</span> <span class='keyword2'>stroke-info</span> ()
  ((color      <span class='keyword3'>:initform</span> nil <span class='keyword3'>:initarg</span> <span class='keyword3'>:color</span>)          <span class='comment'>; (or keyword string)</span>
   (width      <span class='keyword3'>:initform</span> nil <span class='keyword3'>:initarg</span> <span class='keyword3'>:width</span>)          <span class='comment'>; number</span>
   (opacity    <span class='keyword3'>:initform</span> nil <span class='keyword3'>:initarg</span> <span class='keyword3'>:opacity</span>)        <span class='comment'>; number</span>
   (linecap    <span class='keyword3'>:initform</span> nil <span class='keyword3'>:initarg</span> <span class='keyword3'>:linecap</span>)        <span class='comment'>; (or nil keyword)</span>
   (linejoin   <span class='keyword3'>:initform</span> nil <span class='keyword3'>:initarg</span> <span class='keyword3'>:linejoin</span>)       <span class='comment'>; (or nil keyword)</span>
   (miterlimit <span class='keyword3'>:initform</span> nil <span class='keyword3'>:initarg</span> <span class='keyword3'>:miterlimit</span>)     <span class='comment'>; number</span>
   (dasharray  <span class='keyword3'>:initform</span> nil <span class='keyword3'>:initarg</span> <span class='keyword3'>:dasharray</span>)      <span class='comment'>; list</span>
   (dashoffset <span class='keyword3'>:initform</span> nil <span class='keyword3'>:initarg</span> <span class='keyword3'>:dashoffset</span>)))   <span class='comment'>; number</span>
</pre>
<p>　<a class='autolink' href='#60ZvGU5q6jR'>stroke-info</a> クラス向けに、以下の総称関数のメソッドが実装されています。</p>
<ul>
<li>initialize-instance </li>
<li><a class='autolink' href='#dam9QmgaZrq'>check</a> </li>
<li><a class='autolink' href='#kWO3U8sB5EC'>to-property-strings</a></li>
<li><a class='autolink' href='#6KE7wGjrGwN'>to-style-strings</a></li>
</ul>
<h4><a name='ezUVhtPwl3J'></a>3.31.3 make-stroke 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>make-stroke</span> (<span class='keyword2'>&amp;rest</span> params) ... )
</pre>
<p>　<a class='autolink' href='#60ZvGU5q6jR'>stroke-info</a> インスタンスを作成します。パラメータの数や種類に応じて作り方が異なります。</p>
<ul>
<li>パラメータ無しの場合、 <code>*default-stroke*</code> を返します</li>
<li>パラメータ数が 1 の場合、そのパラメータを param として
<ul>
<li>param が <a class='autolink' href='#60ZvGU5q6jR'>stroke-info</a> インスタンスの場合、渡されたものをそのまま返します</li>
<li>param が数値の場合、 <code>(make-stroke :width param)</code> の結果を返します</li>
<li>param がリストの場合、 <code>(apply #'make-stroke param)</code> の結果を返します</li>
<li>上記のいずれでもない場合、 <code>(make-stroke :color param)</code> の結果を返します</li>
</ul>
</li>
<li>パラメータ数が 2 以上の場合、以下の関数のように振舞います。
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>make-stroke</span> (<span class='keyword2'>&amp;key</span> color opacity rule base) ... )
</pre>
<ul>
<li><code>base</code> はその他のパラメータが省略された場合にデフォルト値を取得するための <code>stroke-info</code> インスタンスで、これが省略された場合は <code>*default-stroke*</code> が使用されます。</li>
</ul>
<ul>
<li><code>color</code> は<a class='autolink' href='#1rpUB3fre67'>色の指定</a>です。指定方法の詳細は「<a class='autolink' href='#1rpUB3fre67'>色の指定</a>」を参照してください。</li>
<li><code>width</code> でストロークの幅を指定します。数値で指定します。</li>
<li><code>opacity</code> で透明度を指定します。0 から 1 までの浮動小数点数で指定します。</li>
<li><code>linecap</code> は<span style='background:red;color:white;'>ToDo : まだ記述されていません</span>  <code>:butt :round :square</code></li>
<li><code>linejoin</code> は<span style='background:red;color:white;'>ToDo : まだ記述されていません</span> <code>:miter :round :bevel</code></li>
<li><code>miterlimit</code> は<span style='background:red;color:white;'>ToDo : まだ記述されていません</span></li>
<li><code>dasharray</code> は<span style='background:red;color:white;'>ToDo : まだ記述されていません</span></li>
<li><code>dashoffset</code> は<span style='background:red;color:white;'>ToDo : まだ記述されていません</span></li>
</ul>
</li>
</ul>
<h4><a name='3HMiuSfZ8IU'></a>3.31.4 with-stroke マクロ</h4>
<pre class='code'>
(<span class='keyword1'>defmacro</span> <span class='keyword5'>with-stroke</span> ((<span class='keyword2'>&amp;rest</span> param) <span class='keyword2'>&amp;rest</span> body) ... )
</pre>
<p>　<code>*default-stroke*</code> を一時的に変更します。 <code>params</code> には <a class='autolink' href='#ezUVhtPwl3J'>make-stroke</a> に与えるパラメータと同じものを指定します。以下のコードは、</p>
<pre class='code'>
(with-stroke (<span class='keyword3'>:color</span> <span class='keyword3'>:blue</span> <span class='keyword3'>:width</span> 3)
   ... )
</pre>
<p>　以下と同等です。</p>
<pre class='code'>
(<span class='keyword1'>let</span> ((*default-stroke* (make-stroke <span class='keyword3'>:color</span> <span class='keyword3'>:blue</span> <span class='keyword3'>:width</span> 3)))
   ... )
</pre>
<h3><a name='b75JrIWLwQA'></a>3.32 stylesheet.lisp</h3>
<p>　<a class='autolink' href='#b75JrIWLwQA'>stylesheet.lisp</a> は以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
<li><a class='autolink' href='#h05k6V1sTsF'>entity.lisp</a></li>
<li><a class='autolink' href='#5S5mEI6PrDL'>stroke-info.lisp</a></li>
<li><a class='autolink' href='#au8IebMfeov'>fill-info.lisp</a></li>
<li><a class='autolink' href='#l9bqLva3rj6'>font-info.lisp</a></li>
<li><a class='autolink' href='#7NkNOcI9zDh'>writer.lisp</a></li>
</ul>
<h3><a name='kNkTqs2VjiA'></a>3.33 text-shape.lisp</h3>
<p>　<a class='autolink' href='#kNkTqs2VjiA'>text-shape.lisp</a> は以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
<li><a class='autolink' href='#jkshMjTfNSO'>canvas.lisp</a></li>
<li><a class='autolink' href='#dxGh4wRHKeg'>group.lisp</a></li>
<li><a class='autolink' href='#bFs5bJqLCfb'>paragraph.lisp</a></li>
<li><a class='autolink' href='#l9bqLva3rj6'>font-info.lisp</a></li>
<li><a class='autolink' href='#au8IebMfeov'>fill-info.lisp</a></li>
<li><a class='autolink' href='#5S5mEI6PrDL'>stroke-info.lisp</a></li>
<li><a class='autolink' href='#7NkNOcI9zDh'>writer.lisp</a></li>
</ul>
<h3><a name='e2wwJD0JZFB'></a>3.34 text.lisp</h3>
<p>　<a class='autolink' href='#e2wwJD0JZFB'>text.lisp</a> は以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
<li><a class='autolink' href='#3c2PhHDsO5I'>constants.lisp</a></li>
<li><a class='autolink' href='#h05k6V1sTsF'>entity.lisp</a></li>
<li><a class='autolink' href='#l9bqLva3rj6'>font-info.lisp</a></li>
<li><a class='autolink' href='#k0U5yutENit'>link-info.lisp</a></li>
<li><a class='autolink' href='#7NkNOcI9zDh'>writer.lisp</a></li>
</ul>
<h3><a name='7NkNOcI9zDh'></a>3.35 writer.lisp</h3>
<p>　<a class='autolink' href='#7NkNOcI9zDh'>writer.lisp</a> は以下のコンポーネントに依存しています。</p>
<ul>
<li><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
</ul>
<p>　<a class='autolink' href='#7NkNOcI9zDh'>writer.lisp</a> では、<a class='autolink' href='#lfl3LZgcQAj'>buffer-writer</a> クラスを定義しています。</p>
<h4><a name='lfl3LZgcQAj'></a>3.35.1 buffer-writer クラス</h4>
<p>　<a class='autolink' href='#2xCCaUuNLlH'>diagram</a> において SVG データを出力するために使用するクラスです。基本的には、以下のように使用します。</p>
<ul>
<li><a class='autolink' href='#b2iyvLVaRzT'>create-svg-writer</a> 関数でインスタンスを作成し、</li>
<li><a class='autolink' href='#4OQ1LGMatRX'>writer-incr-level</a> / <a class='autolink' href='#fFHRToz0LBB'>writer-decr-level</a> メソッドでインデントを調整</li>
<li><a class='autolink' href='#k0nOlL9rkAA'>writer-write</a> メソッドで行を出力</li>
<li><a class='autolink' href='#27c0tsawNaI'>writer-close</a> メソッドで出力全体の文字列を取得</li>
</ul>
<h5><a name='k0nOlL9rkAA'></a>3.35.1.1 writer-write メソッド</h5>
<pre class='code'>
(<span class='keyword1'>defmethod</span> <span class='keyword5'>writer-write</span> ((writer buffer-writer) <span class='keyword2'>&amp;rest</span> params) ... )
</pre>
<p>　一回の呼び出しで 1 行を出力します。このとき、</p>
<ul>
<li><a class='autolink' href='#4OQ1LGMatRX'>writer-incr-level</a> / <a class='autolink' href='#fFHRToz0LBB'>writer-decr-level</a> メソッドで指定されたレベル数分だけタブを出力します</li>
<li><code>params</code> で与えられた複数のパラメータを順番に出力します
<ul>
<li><code>nil</code> は出力しません</li>
<li>キーワードシンボルはその文字列表現を小文字にしたものを出力します</li>
<li>整数でない数値は、 <code>single-float</code> に <code>coerce</code> したものを <code>format "~F"</code> で出力します</li>
<li>上記のいずれにも該当しない場合、 <code>format "~A"</code> で出力します</li>
</ul>
</li>
<li>最後に改行コードを出力します</li>
</ul>
<h5><a name='4OQ1LGMatRX'></a>3.35.1.2 writer-incr-level メソッド</h5>
<pre class='code'>
(<span class='keyword1'>defmethod</span> <span class='keyword5'>writer-incr-level</span> ((writer buffer-writer)) ... )
</pre>
<p>　<a class='autolink' href='#lfl3LZgcQAj'>buffer-writer</a> インスタンスのインデントレベルをひとつ増加させます。これは <a class='autolink' href='#k0nOlL9rkAA'>writer-write</a> メソッドでの出力に影響します。</p>
<h5><a name='fFHRToz0LBB'></a>3.35.1.3 writer-decr-level メソッド</h5>
<pre class='code'>
(<span class='keyword1'>defmethod</span> <span class='keyword5'>writer-decr-level</span> ((writer buffer-writer)) ... )
</pre>
<p>　<a class='autolink' href='#lfl3LZgcQAj'>buffer-writer</a> インスタンスのインデントレベルをひとつ減少させます。これは <a class='autolink' href='#k0nOlL9rkAA'>writer-write</a> メソッドでの出力に影響します。</p>
<h5><a name='27c0tsawNaI'></a>3.35.1.4 writer-close メソッド</h5>
<pre class='code'>
(<span class='keyword1'>defmethod</span> <span class='keyword5'>writer-close</span> ((writer buffer-writer)) ... )
</pre>
<p>　<a class='autolink' href='#lfl3LZgcQAj'>buffer-writer</a> のストリームを閉じ、そのストリームにバッファリングされていた文字列を返します。</p>
<h4><a name='b2iyvLVaRzT'></a>3.35.2 create-svg-writer 関数</h4>
<pre class='code'>
(<span class='keyword1'>defun</span> <span class='keyword5'>create-svg-writer</span> () ... )
</pre>
<p>　<a class='autolink' href='#lfl3LZgcQAj'>buffer-writer</a> クラスを作成して返します。パラメータは取りません。</p>
<p>　　</p>
<h2><a name='1ewHzjI62xn'></a>4 索引</h2>
<details class='idx_x' open>
<summary class='idx_x'>Symbols</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#g99vlb6tXRZ'>*default-fill*</a></li>
<li class='idx_x'><a class='autolink' href='#7pITpDTSaVn'>*default-stroke*</a></li>
<li class='idx_x'><a class='autolink' href='#aILr24BuzyN'>__write-imp</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>A</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#5PHdXU1SAwU'>arc.lisp</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>B</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#h7eqOL9fNA4'>begin-id-group</a></li>
<li class='idx_x'><a class='autolink' href='#jRts0Y6YUfH'>binutil.lisp</a></li>
<li class='idx_x'><a class='autolink' href='#lfl3LZgcQAj'>buffer-writer</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>C</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#3KzHqSMKOM6'>canvas-bottom</a></li>
<li class='idx_x'><a class='autolink' href='#g2Q4C1SxBla'>canvas-dict-bottom</a></li>
<li class='idx_x'><a class='autolink' href='#iyqoOBS1Fx2'>canvas-dict-bottomleft</a></li>
<li class='idx_x'><a class='autolink' href='#6sY8VX3mC8y'>canvas-dict-bottomright</a></li>
<li class='idx_x'><a class='autolink' href='#jbqMd3uQuTg'>canvas-dict-center</a></li>
<li class='idx_x'><a class='autolink' href='#42betqaDwBK'>canvas-dict-height</a></li>
<li class='idx_x'><a class='autolink' href='#jY1KoLc5Ygu'>canvas-dict-left</a></li>
<li class='idx_x'><a class='autolink' href='#8QTTuc8dfLe'>canvas-dict-right</a></li>
<li class='idx_x'><a class='autolink' href='#6LB76PkdkZJ'>canvas-dict-top</a></li>
<li class='idx_x'><a class='autolink' href='#g1qrFI5J49t'>canvas-dict-topleft</a></li>
<li class='idx_x'><a class='autolink' href='#dHAbaoBcL3P'>canvas-dict-topright</a></li>
<li class='idx_x'><a class='autolink' href='#5r9jjHGdPUD'>canvas-dict-width</a></li>
<li class='idx_x'><a class='autolink' href='#5zrSjOXYv2S'>canvas-fix-point</a></li>
<li class='idx_x'><a class='autolink' href='#gl7uceIWuvQ'>canvas-height</a></li>
<li class='idx_x'><a class='autolink' href='#cSuiLry4j2n'>canvas-left</a></li>
<li class='idx_x'><a class='autolink' href='#1HAaPkwx2sJ'>canvas-p</a></li>
<li class='idx_x'><a class='autolink' href='#fM6z1S2PXli'>canvas-right</a></li>
<li class='idx_x'><a class='autolink' href='#6vlqkJUhc5s'>canvas-top</a></li>
<li class='idx_x'><a class='autolink' href='#efXUIZFt7c7'>canvas-topleft</a></li>
<li class='idx_x'><a class='autolink' href='#kz1CArkN4MX'>canvas-width</a></li>
<li class='idx_x'><a class='autolink' href='#jkshMjTfNSO'>canvas.lisp</a></li>
<li class='idx_x'><a class='autolink' href='#kiT1zMbnS1G'>caution</a></li>
<li class='idx_x'><a class='autolink' href='#dam9QmgaZrq'>check</a></li>
<li class='idx_x'><a class='autolink' href='#kXeJPcGPcpP'>check-and-draw-local-entity</a></li>
<li class='idx_x'><a class='autolink' href='#byoOCbZmVzI'>check-keywords</a></li>
<li class='idx_x'><a class='autolink' href='#4agHkkJhiI1'>check-member</a></li>
<li class='idx_x'><a class='autolink' href='#7OeiJB9pyPw'>check-numbers</a></li>
<li class='idx_x'><a class='autolink' href='#8UPDTpCxfvu'>check-object</a></li>
<li class='idx_x'><a class='autolink' href='#9c7EgdLRM3i'>chk-type</a></li>
<li class='idx_x'><a class='autolink' href='#0vu6jIAdrHn'>circle.lisp</a></li>
<li class='idx_x'><a class='autolink' href='#6qK0TBix0mp'>cl-diagram.lisp</a></li>
<li class='idx_x'><a class='autolink' href='#gjxTJAKDoPj'>connector.lisp</a></li>
<li class='idx_x'><a class='autolink' href='#3c2PhHDsO5I'>constants.lisp</a></li>
<li class='idx_x'><a class='autolink' href='#cTwJaoEIPT1'>copy-canvas</a></li>
<li class='idx_x'><a class='autolink' href='#i9EtqjnJKkh'>copy-point</a></li>
<li class='idx_x'><a class='autolink' href='#bpd2tQ1LZ9f'>create-svg</a></li>
<li class='idx_x'><a class='autolink' href='#b2iyvLVaRzT'>create-svg-writer</a></li>
<li class='idx_x'><a class='autolink' href='#jCwDkKC4S8s'>create-svg.lisp</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>D</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#2xCCaUuNLlH'>diagram</a></li>
<li class='idx_x'><a class='autolink' href='#6XTh8JnAh0Q'>dict-create</a></li>
<li class='idx_x'><a class='autolink' href='#ihOjTTad5LY'>dict-get-entity</a></li>
<li class='idx_x'><a class='autolink' href='#1X7zDLB8Dho'>dict-register</a></li>
<li class='idx_x'><a class='autolink' href='#8sXKk1Q8d2H'>dictionary</a></li>
<li class='idx_x'><a class='autolink' href='#kCVvdOT2S7L'>dictionary.lisp</a></li>
<li class='idx_x'><a class='autolink' href='#eRs3IQibPlS'>draw-entity</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>E</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#hd7ThdvzqQq'>ellipse.lisp</a></li>
<li class='idx_x'><a class='autolink' href='#bFrl4dwpxKu'>end-id-group</a></li>
<li class='idx_x'><a class='autolink' href='#4V2uI4HhR9d'>endmark-info.lisp</a></li>
<li class='idx_x'><a class='autolink' href='#coMfaBWu7eG'>entity</a></li>
<li class='idx_x'><a class='autolink' href='#dBxV4D4cAYB'>entity-composition-p</a></li>
<li class='idx_x'><a class='autolink' href='#h05k6V1sTsF'>entity.lisp</a></li>
<li class='idx_x'><a class='autolink' href='#koEWNsjRkGS'>escape-characters</a></li>
<li class='idx_x'><a class='autolink' href='#8n4YMx0lEny'>exception</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>F</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#fDv1lctqo7i'>fill-info</a></li>
<li class='idx_x'><a class='autolink' href='#au8IebMfeov'>fill-info.lisp</a></li>
<li class='idx_x'><a class='autolink' href='#8bLRXqBRaO7'>fix-name</a></li>
<li class='idx_x'><a class='autolink' href='#l9bqLva3rj6'>font-info.lisp</a></li>
<li class='idx_x'><a class='autolink' href='#ctyQaetTK05'>format-string</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>G</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#dxGh4wRHKeg'>group.lisp</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>I</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#4ukAyTPlA3e'>image.lisp</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>L</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#hNccIQgX3H4'>label-info.lisp</a></li>
<li class='idx_x'><a class='autolink' href='#g6PVqK0GAdf'>layer-manager.lisp</a></li>
<li class='idx_x'><a class='autolink' href='#7Y5KOwJXVqF'>line.lisp</a></li>
<li class='idx_x'><a class='autolink' href='#k0U5yutENit'>link-info.lisp</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>M</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#92zJ4HjAUik'>make-canvas</a></li>
<li class='idx_x'><a class='autolink' href='#8IkB7VinE7h'>make-fill</a></li>
<li class='idx_x'><a class='autolink' href='#cV08aR4hVCU'>make-point</a></li>
<li class='idx_x'><a class='autolink' href='#ezUVhtPwl3J'>make-stroke</a></li>
<li class='idx_x'><a class='autolink' href='#19JyiABSLdD'>math/cos1</a></li>
<li class='idx_x'><a class='autolink' href='#9Uw5mXSJ6LO'>math/cos2</a></li>
<li class='idx_x'><a class='autolink' href='#kMKsf1DD0li'>math/cos3</a></li>
<li class='idx_x'><a class='autolink' href='#cjix05YHSz4'>math/cos4</a></li>
<li class='idx_x'><a class='autolink' href='#1cLxT7jnweu'>math/cos5</a></li>
<li class='idx_x'><a class='autolink' href='#67nITShIFxJ'>math/len2</a></li>
<li class='idx_x'><a class='autolink' href='#g56JpESyFgh'>math/len4</a></li>
<li class='idx_x'><a class='autolink' href='#fCFNMHaH1sc'>math/sin1</a></li>
<li class='idx_x'><a class='autolink' href='#hvzNb6abVJr'>math/sin2</a></li>
<li class='idx_x'><a class='autolink' href='#6pdmmd85Tsd'>math/sin3</a></li>
<li class='idx_x'><a class='autolink' href='#4NyvBxygvjx'>math/sin4</a></li>
<li class='idx_x'><a class='autolink' href='#fFCXUJE5Dqj'>math/sin5</a></li>
<li class='idx_x'><a class='autolink' href='#0uaBbu9jd7a'>mathutil.lisp</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>O</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#8P16jLcfrTL'>onlisp/flatten</a></li>
<li class='idx_x'><a class='autolink' href='#amdyJtzHvGs'>onlisp/keysymb</a></li>
<li class='idx_x'><a class='autolink' href='#fO1t1ED8A9I'>onlisp/mkstr</a></li>
<li class='idx_x'><a class='autolink' href='#kGO3CobDdFK'>onlisp/symb</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>P</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#bFs5bJqLCfb'>paragraph.lisp</a></li>
<li class='idx_x'><a class='autolink' href='#9k30aVu2Utl'>path.lisp</a></li>
<li class='idx_x'><a class='autolink' href='#hMXfb1i1Vwi'>path/get-current-directory</a></li>
<li class='idx_x'><a class='autolink' href='#6UyJ4WDXJRL'>path/get-time</a></li>
<li class='idx_x'><a class='autolink' href='#jwjWt2iFfEC'>path/is-directory-name</a></li>
<li class='idx_x'><a class='autolink' href='#9bWAiPeVsu8'>path/is-existing-file</a></li>
<li class='idx_x'><a class='autolink' href='#0gP9e1yak7W'>path/is-exists</a></li>
<li class='idx_x'><a class='autolink' href='#dnb6iFWVo0r'>path/is-file-name</a></li>
<li class='idx_x'><a class='autolink' href='#59X9Til78JV'>path/set-current-directory</a></li>
<li class='idx_x'><a class='autolink' href='#kEmV3k1rXYD'>pathutil.lisp</a></li>
<li class='idx_x'><a class='autolink' href='#fCZ08hHsf3N'>point+</a></li>
<li class='idx_x'><a class='autolink' href='#6mwEJ7qyOKN'>point-</a></li>
<li class='idx_x'><a class='autolink' href='#k76Q8kszUmj'>point-absolute-p</a></li>
<li class='idx_x'><a class='autolink' href='#1cQLTt5yCRi'>point-distance</a></li>
<li class='idx_x'><a class='autolink' href='#eYsB94h8ozm'>point-p</a></li>
<li class='idx_x'><a class='autolink' href='#8ARSCNEXCwM'>point-relative-p</a></li>
<li class='idx_x'><a class='autolink' href='#et6gePtgg50'>point-x</a></li>
<li class='idx_x'><a class='autolink' href='#3B2wOhg6fxU'>point-y</a></li>
<li class='idx_x'><a class='autolink' href='#g7U0GGx7sCV'>point.lisp</a></li>
<li class='idx_x'><a class='autolink' href='#lEZ6oy96fUH'>point/x+</a></li>
<li class='idx_x'><a class='autolink' href='#3nSG8ftc6m8'>point/xy+</a></li>
<li class='idx_x'><a class='autolink' href='#awgH1J8YsIC'>point/y+</a></li>
<li class='idx_x'><a class='autolink' href='#ggdkX0SpYat'>polygon.lisp</a></li>
<li class='idx_x'><a class='autolink' href='#9lFMWTnv8EC'>post-draw</a></li>
<li class='idx_x'><a class='autolink' href='#aOXIgO3wNWv'>pre-draw</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>R</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#g7IEYVlAFRK'>raw-svg.lisp</a></li>
<li class='idx_x'><a class='autolink' href='#c1IDRaD20g3'>rectangle.lisp</a></li>
<li class='idx_x'><a class='autolink' href='#7QraN5WNGea'>rgb</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>S</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#f9LBhHlQ8Wm'>shape</a></li>
<li class='idx_x'><a class='autolink' href='#5oyJIEI5Oql'>shape-bottom</a></li>
<li class='idx_x'><a class='autolink' href='#jDeI5NMpwGo'>shape-bottomleft</a></li>
<li class='idx_x'><a class='autolink' href='#3LYUCViihmz'>shape-bottomright</a></li>
<li class='idx_x'><a class='autolink' href='#cGVh1Proq0b'>shape-cc-center</a></li>
<li class='idx_x'><a class='autolink' href='#9FXddyX6ENz'>shape-center</a></li>
<li class='idx_x'><a class='autolink' href='#itSpZJR99MH'>shape-connect-point</a></li>
<li class='idx_x'><a class='autolink' href='#00NZ1og0jJj'>shape-get-subcanvas</a></li>
<li class='idx_x'><a class='autolink' href='#lNU1gDLketF'>shape-height</a></li>
<li class='idx_x'><a class='autolink' href='#jmh0xrnq31t'>shape-left</a></li>
<li class='idx_x'><a class='autolink' href='#h5SgyhRzdMg'>shape-right</a></li>
<li class='idx_x'><a class='autolink' href='#kt6vKeEZlsN'>shape-top</a></li>
<li class='idx_x'><a class='autolink' href='#7aZE8rCgP1F'>shape-topleft</a></li>
<li class='idx_x'><a class='autolink' href='#85obV2niPlm'>shape-topright</a></li>
<li class='idx_x'><a class='autolink' href='#2UPPgaElgvy'>shape-width</a></li>
<li class='idx_x'><a class='autolink' href='#jzen8zyw08N'>shape.lisp</a></li>
<li class='idx_x'><a class='autolink' href='#0ACA2jPppKO'>stencil.lisp</a></li>
<li class='idx_x'><a class='autolink' href='#dQph0tOdHQ4'>string/mid</a></li>
<li class='idx_x'><a class='autolink' href='#dS6SufHR3Ix'>string/replace</a></li>
<li class='idx_x'><a class='autolink' href='#gtO8775YqBc'>string/split</a></li>
<li class='idx_x'><a class='autolink' href='#60ZvGU5q6jR'>stroke-info</a></li>
<li class='idx_x'><a class='autolink' href='#5S5mEI6PrDL'>stroke-info.lisp</a></li>
<li class='idx_x'><a class='autolink' href='#b75JrIWLwQA'>stylesheet.lisp</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>T</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#kNkTqs2VjiA'>text-shape.lisp</a></li>
<li class='idx_x'><a class='autolink' href='#e2wwJD0JZFB'>text.lisp</a></li>
<li class='idx_x'><a class='autolink' href='#g7f5yssQwTG'>throw-caution</a></li>
<li class='idx_x'><a class='autolink' href='#hKajqxDpSVa'>throw-exception</a></li>
<li class='idx_x'><a class='autolink' href='#kWO3U8sB5EC'>to-property-strings</a></li>
<li class='idx_x'><a class='autolink' href='#6KE7wGjrGwN'>to-style-strings</a></li>
<li class='idx_x'><a class='autolink' href='#4MzkIlZeOig'>type-assert</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>W</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#8SwZig7eicm'>with-canvas</a></li>
<li class='idx_x'><a class='autolink' href='#k9ex0jPxy6W'>with-dictionary</a></li>
<li class='idx_x'><a class='autolink' href='#apbktIICmZP'>with-fill</a></li>
<li class='idx_x'><a class='autolink' href='#ekClPzGH4mL'>with-point</a></li>
<li class='idx_x'><a class='autolink' href='#3HMiuSfZ8IU'>with-stroke</a></li>
<li class='idx_x'><a class='autolink' href='#a48ATArhBUk'>with-subcanvas</a></li>
<li class='idx_x'><a class='autolink' href='#3ffyzBxLMJk'>write-header</a></li>
<li class='idx_x'><a class='autolink' href='#banMcDxF6dd'>write-when</a></li>
<li class='idx_x'><a class='autolink' href='#27c0tsawNaI'>writer-close</a></li>
<li class='idx_x'><a class='autolink' href='#fFHRToz0LBB'>writer-decr-level</a></li>
<li class='idx_x'><a class='autolink' href='#4OQ1LGMatRX'>writer-incr-level</a></li>
<li class='idx_x'><a class='autolink' href='#k0nOlL9rkAA'>writer-write</a></li>
<li class='idx_x'><a class='autolink' href='#7NkNOcI9zDh'>writer.lisp</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>X</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#lEZ6oy96fUH'>x+</a></li>
<li class='idx_x'><a class='autolink' href='#3nSG8ftc6m8'>xy+</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>Y</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#awgH1J8YsIC'>y+</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>Others</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#hQqTfTkbNyq'>エンティティ</a></li>
<li class='idx_x'><a class='autolink' href='#jXsxcbXYkll'>キャンバス</a></li>
<li class='idx_x'><a class='autolink' href='#hv2FXS6j5gn'>ディクショナリ</a></li>
<li class='idx_x'><a class='autolink' href='#1rpUB3fre67'>色の指定</a></li>
</blockquote>
</details>
<p>　　</p>
<hr>
</body>
</html>
